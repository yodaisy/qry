
----- ############################################################
--- * *********** AUTOMATION    ***************************************************************************************************************************************************

select *
from DBREGRP.plan_prov_grp
where account_no like 'Q51658%'--'QK61975MB 00001')
--('TT080313MB00001','TT069112MB00001','TT069202DB00001','TT069071MB00001','QK62165MB 00001','QK62027MB 00001','QK61855MB 00001','QK61440MB 00001','JK62197DB 00001',
--'QK62132MB 00001','JK62150DB 00001','QK62536MB 00001')
;

--'JK62202MB%'
select *
from DBREGRC.plan_prov_grp
where (account_no like 'PE61743MB%'  or account_no like 'QK62302DL %')
and CONV_STAT_C <> 0
;

select *
from DBREGRC.plan_provision
where enrl_prov_grp_I = 43465758898025100 
and provision_i in (select class_prov_i from DBREGRC.plan_class where class_prov_i = provision_i)
;
select *
from DBREGRC.plan_class
where class_prov_i= 75982369898025100
;

select *
from DBREGRC.plan_prov_grp pgrp
where pgrp.account_no like 'JK62202MB%'
and pgrp.enrl_prov_grp_I in (select enrl_prov_grp_i from DBREGRC.part_def_data where enrl_prov_grp_i = pgrp.enrl_prov_grp_i)
for fetch only with ur;


select *
from DBREGRP.eds_enrl
for fetch only with ur;

select * from DBREGRC.part_auto_def
where soc_sec_no in ('003-62-3867')
for fetch only with ur;



-- DBREGRT   ou  DBREGRP ou C
SELECT * 
from  DBREGRC.EMPLOYEE
WHERE 
--CASE_NO ='QK62536MB 00001' 
  soc_sec_no in ('274-82-0573') --('999-99-9915', '999-99-9912','999-99-9913','999-99-9914','999-99-9915','999-99-9916','999-99-9917','999-99-9918','999-91-9919','999-99-1000','999-99-1001','023-44-0869','041-54-1025',
--'150-44-3958')
--order by soc_sec_no
for fetch only with ur;


--sc 10.1
SELECT CASE_NO, SOC_SEC_NO, EE_DIV_NO, ER_DIV_NO, KEY_PER_STAT_CD, EE_BRTH_DT, EE_PLAN_ENTRY_DT, EE_HIRE_DT, EE_TERM_DT, EE_NO, EE_FST_MID_NM, EE_LAST_NM, EE_SEX_CD, EMPL_STAT_CD, PART_STAT_CD, EE_MARITAL_STAT_CD, EE_REHIRE_DT, EE_REENTRY_DT, MIDDLE_NM,class_i,  MOD_TS 
FROM DBREGRT.EMPLOYEE
WHERE 
--CASE_NO = 'TT080332LK00001'
SOC_SEC_NO in ( '002-52-1239', '002-62-4773', '003-60-4711', '004-44-7746', '006-66-4164')
;

SELECT * 
from  DBREGRC.EMPLOYEE
WHERE 
--CASE_NO ='QK62536MB 00001' QK62158MB 00001
   soc_sec_no in ('999-99-1004', '999-99-1005' ) --'275-76-9187', '311-78-3373', '484-76-6357')
for fetch only with ur;

SELECT * 
from  DBREGRP.EDS_ENRL
WHERE 
--CASE_NO ='QK62536MB 00001' QK62158MB 00001
   soc_sec_no in ('999-99-1004', '999-99-1005' ) --('150-44-3958')
for fetch only with ur;



SELECT * FROM DBREGRC.EMPLOYEE
WHERE CASE_NO = 'QK62536MB 00001'
AND SOC_SEC_NO = '023-44-0869'

SELECT * FROM DBREGRC.EDS_LOAD_DATA
WHERE SOC_SEC_NO = '023-44-0869'

SELECT * FROM DBREGRC.EDS_ENRL
WHERE 
--CASE_NO = 'QK62536MB 00001'
 SOC_SEC_NO = '041-54-1025'
;

--get the list of valid remit codes for specific case number
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   
	DBREGRC.CO_SOURCE CS, 
	DBREGRC.PLAN_PROV_GRP PPG, 
    DBREGRC.PLAN_PROVISION PP, 
    DBREGRC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO like 'QK62158MB 00001%'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;

SELECT * FROM   
	DBREGRC.CO_SOURCE CS, 
	DBREGRC.PLAN_PROV_GRP PPG, 
    DBREGRC.PLAN_PROVISION PP, 
    DBREGRC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO = 'QK62158MB 00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;


-- from sc 10.6

-- from sc 10.5 - rehire

select *
from DBREGRT.plan_prov_grp
where account_no like 'TT069090MP%'
and RELATED_GRP_TYP_C = 361
;

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRT.EMPLOYEE
WHERE soc_sec_no in ('002-62-4773','005-84-4121')
;


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in ('002-62-4773','274-82-0573',
'271-80-5864',
'228-17-2254',
'163-52-6948',
'063-54-3671',
'270-76-1436',
'271-68-0146')
;

--scenario 4.4
SELECT * FROM DBREGRC.EMPLOYEE
WHERE CASE_NO = 'JK62202MB 00001' and soc_sec_no in ('003-62-3867')
for fetch only with ur; 
--defferals
select * from DBREGRC.part_def_data
where soc_sec_no in ('999-99-1002', '999-99-1003')
order by mod_ts desc;


--deferrals  corp
select *
from DBSYSTC.plan_prov_grp pgrp
where pgrp.account_no like 'QK62536%'-- 'JK62130%'
--'QK62158LY%'
--'JK62150FC%'
and pgrp.enrl_prov_grp_I in (select enrl_prov_grp_i from DBSYSTC.part_def_data where enrl_prov_grp_i = pgrp.enrl_prov_grp_i)
for fetch only with ur
;
--70943919652222739



select * from DBSYSTC.part_enrl_xref
where soc_sec_no in ('999-99-1003')
--ACCOUNT_NO,ENRL_PROV_GRP_I,RELATED_GRP_TYP_C,SOC_SEC_NO,PART_ENRL_I,PERSON_I,CREATE_TS,MOD_TS,SURROGATE_KEY
--JK62197PM 00001,21673123238594386,361,999-99-1003,6675043749483500,95675043749483500,2018-01-24-13.52.20.880578,2018-01-24-13.52.20.880578,106223446
;
select * from DBSYSTC.part_def_data
where ENRL_PROV_GRP_I=21673123238594386
;

select * from DBSYSTC.part_enrl_xref --part_def_data
where soc_sec_no in ('999-99-1003');
--part_enrol_i = 6675043749483500    
;
select * from DBSYSTC.part_enrl_xref
where part_enrl_i = 28040919652222739 ; 

--i created row for this SSN
select * from DBSYSTC.part_def_data
where 
--part_enrl_i = 28040919652222739 ;
soc_sec_no in ('999-99-1003',  '026-78-0537')
order by mod_ts desc;
*
--to automation queries
select * from DBSYSTC.part_def_data
where soc_sec_no = '026-78-0537' and stat_c = 'A'
order by mod_ts desc;

SELECT * FROM DBSYSTC.EMPLOYEE
WHERE soc_sec_no in ( '999-99-1004', '999-99-1005','026-78-0537' ) --,'999-99-1003') 026780537
and case_no = 'JK62197PM 00001' 
for fetch only with ur;

SELECT * FROM DBSYSTC.EMPLOYEE
WHERE soc_sec_no in ('026-78-0537')
and case_no = 'JK62197PM 00001'
for fetch only with ur;

--returns ENRL_PROV_GRP_I and PART_ENRL_I
select ACCOUNT_NO,SOC_SEC_NO,ENRL_PROV_GRP_I,PART_ENRL_I 
from DBSYSTC.part_enrl_xref
where account_no = 'JK62197PM 00001' and soc_sec_no = '026-78-0537'
for fetch only with ur

-- to automation queries
select * from DBSYSTC.part_def_data
where 
soc_sec_no = '026-78-0537' 
and ENRL_PROV_GRP_I = '21673123238594386'
and PART_ENRL_I = '40092305429686'
and stat_c = 'A'
order by mod_ts desc
;

--qry for automation
Update DBSYSTC.PART_DEF_DATA 
Set DEF_A=0.00, DEF_P=0.000, DATA_CH_ORIG_C = ''
where SOC_SEC_NO='026-78-0537' AND STAT_C='A' AND ENRL_PROV_GRP_I=21673123238594386 AND PART_ENRL_I=40092305429686 AND src_i = 30510975058594386 and def_grp_i = 46777513169142486
;


--join
select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBSYSTC.part_enrl_xref xref, DBSYSTC.part_def_data dd
where xref.account_no = 'QK62158LY 00001' and xref.soc_sec_no = '487-16-2463'--'JK62197PM 00001' and xref.soc_sec_no = '026-78-0537'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.STAT_C='A'
order by dd.mod_ts desc
for fetch only with ur
--return  ENRL_PROV_GRP_I and PART_ENRL_I, SRC_I and DEF_GRP_I, DEF_A and DEF_P  of the newest active record
;

--PART_ENRL_I    ,ENRL_PROV_GRP_I,SOC_SEC_NO  ,DEF_GRP_I
--40092305429686,21673123238594386,026-78-0537,46777513169142486
select *
from DBSYSTC.eds_enrl
where ENRL_PROV_GRP_I = 21673123238594386
and soc_sec_no = '026-78-0537'
for fetch only with ur;

select *
from DBSYSTC.eds_enrl
where 
soc_sec_no = '026-78-0537'
for fetch only with ur;

select * from DBSYSTC.part_auto_def
where soc_sec_no = '026-78-0537' --and account_no = 'JK62197PM 00001'
for fetch only with ur;


------------------------------------------ sc term dt
SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'576-46-8384',
'004-37-0834',
'037-14-6031',
'003-85-1498',
'004-16-5669',
'027-11-7642',
'017-51-7924',
'006-66-4164',
'772-16-3184',
'010-72-0872',
'001-38-6984',
'001-44-2482',
'004-50-2815',
'005-86-3116',
'001-36-6685',
'003-78-6360',
'009-62-6332',
'074-70-3780',
'006-72-5841',
'002-90-6609',
'003-58-7148')
;


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRT.EMPLOYEE
WHERE soc_sec_no in (
'006-66-4164',
'772-16-3184',
'010-72-0872',
'001-38-6984' )

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRT.EMPLOYEE
WHERE soc_sec_no in (
'576-46-8384',
'004-37-0834',
'037-14-6031',
'003-85-1498',
'004-16-5669',
'027-11-7642',
'017-51-7924',
'006-66-4164',
'772-16-3184',
'010-72-0872',
'001-38-6984',
'001-44-2482',
'004-50-2815',
'005-86-3116',
'001-36-6685',
'003-78-6360',
'009-62-6332',
'074-70-3780',
'006-72-5841',
'002-90-6609',
'003-58-7148')
;

--sc 1 to 8

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'067-42-4842',
'568-97-0563',
'395-60-4266',
'156-46-7907',
'527-11-1717',
'065-42-6056',
'434-27-8948',
'567-64-0824' )
--and case_no like 'QK61855MB %'
;

select * from DBREGRT.part_def_data
where soc_sec_no in (
'067-42-4842',
'568-97-0563',
'395-60-4266',
'156-46-7907',
'527-11-1717',
'065-42-6056',
'434-27-8948',
'567-64-0824' )
order by soc_sec_no, mod_ts desc;
;


--

--sc 5 and 6

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'527-11-1717','065-42-6056')
;

select * from DBREGRC.part_def_data
where soc_sec_no in (
'527-11-1717','065-42-6056')
;

--sc 7 and 8

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'434-27-8948','567-64-0824')
;

select * from DBREGRC.part_def_data
where soc_sec_no in (
'434-27-8948','567-64-0824')
;

--sc 9 to 11



SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'281-80-3283',
'394-44-3631',
'251-08-9294',
'072-76-8440',
'066-46-8675',
'225-43-0862' )
and case_no like 'QK61855MB %'
;

select * from DBREGRT.part_def_data
where soc_sec_no in ('281-80-3283',
'394-44-3631',
'251-08-9294',
'072-76-8440',
'066-46-8675',
'225-43-0862' )
order by mod_ts desc;


-- sc 12 to 23
SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'615-17-6410',
'551-43-1082',
'582-45-9535',
'319-66-2406',
'349-36-5580',
'361-46-9695',
'574-72-5228',
'551-57-9680',
'148-56-1982',
'141-50-5491',
'526-52-3113',
'576-46-8384' )
;

select * from DBREGRC.part_def_data
where soc_sec_no in (
'615-17-6410',
'551-43-1082',
'582-45-9535',
'319-66-2406',
'349-36-5580',
'361-46-9695',
'574-72-5228',
'551-57-9680',
'148-56-1982',
'141-50-5491',
'526-52-3113',
'576-46-8384' )
order by mod_ts desc;




-- sc 18 to 21

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'574-72-5228',
'551-57-9680',
'148-56-1982' )
--and case_no like 'QK61855MB %'
for fetch only with ur
;


select * from DBREGRC.part_def_data
where soc_sec_no in (
'574-72-5228',
'551-57-9680',
'148-56-1982'
);


--sc 27 to 29


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'004-37-0834',
'037-14-6031',
'003-85-1498' )
and case_no like 'QK62454%'
;

select * from DBREGRC.part_def_data
where soc_sec_no in ('004-37-0834', '037-14-6031', '003-85-1498')
order by mod_ts desc;
-- did not return data for these ppt's

--join
select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBREGRT.part_enrl_xref xref, DBREGRT.part_def_data dd
where xref.account_no = 'QK62454DC 00001' and xref.soc_sec_no = '003-85-1498'--'JK62197PM 00001' and xref.soc_sec_no = '026-78-0537'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.STAT_C='A'
order by dd.mod_ts desc
for fetch only with ur
;


--sc 31  sc 11.1

-- sc 31 - sc 11.1


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'001-44-2482',
'004-50-2815',
'005-86-3116' )
for fetch only with ur
;

select * from DBREGRC.part_def_data
where soc_sec_no in (
'001-44-2482',
'004-50-2815',
'005-86-3116' )
order by mod_ts desc;


-- sc 34 to 37

-- new sc 34 - sc 12.1  to   37


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in (
'074-70-3780',
'006-72-5841',
'002-90-6609',
'003-58-7148' )
for fetch only with ur
;

select * from DBREGRC.part_def_data
where soc_sec_no in (
'074-70-3780',
'006-72-5841',
'002-90-6609',
'003-58-7148' )
order by mod_ts desc;


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRT.EMPLOYEE
WHERE soc_sec_no in (
'002-90-6609',
'003-58-7148' )
for fetch only with ur
;

select * from DBREGRT.part_def_data
where soc_sec_no in (
'002-90-6609',
'003-58-7148' )
order by mod_ts desc;



select CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from DBREGRC.employee
where soc_sec_no in (
'074-70-3780',
'006-72-5841'
 )
order by mod_ts desc;

-- new sc 27 to 30


select CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_DIV_NO, EE_MARITAL_STAT_CD, EE_PAYROLL_FREQ_CD,ELIG_PRC_STAT_C, CLASS_I, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from DBREGRT.employee
where soc_sec_no in (
'006-66-4164',
'772-16-3184',
'010-72-0872',
'001-38-6984'
 )
;



select * from DBREGRC.part_def_data
where soc_sec_no in (
'006-66-4164',
'772-16-3184',
'010-72-0872',
'001-38-6984' )
order by mod_ts desc;


-- sc 30 to 32 (review this numeration

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, EE_MARITAL_STAT_CD, ELIG_PRC_STAT_C, CLASS_I, EE_PAYROLL_FREQ_CD, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE soc_sec_no in ('004-16-5669',
'017-51-7924',
'027-11-7642')
and case_no like 'QK62454%'
;

select * from DBREGRC.part_def_data
where soc_sec_no in ('004-16-5669',
'017-51-7924',
'027-11-7642')
order by mod_ts desc;
--it returned data

select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBREGRT.part_enrl_xref xref, DBREGRT.part_def_data dd
where xref.account_no = 'QK62454DC 00001' and xref.soc_sec_no = '004-16-5669'--'JK62197PM 00001' and xref.soc_sec_no = '026-78-0537'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.STAT_C='A'
order by dd.mod_ts desc
for fetch only with ur
;




-------------------------------


-- regression
--sc 4.3
SELECT *
from  DBREGRC.EMPLOYEE
WHERE 
case_no = 'QK62158MB 00001' and
 soc_sec_no = '540-34-2314'
for fetch only with ur;

	

select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBREGRC.part_enrl_xref xref, DBREGRC.part_def_data dd
where xref.account_no = 'QK62158MB 00001' and xref.soc_sec_no = '540-34-2314' --xref.account_no = 'JK62130MB 00001' and xref.soc_sec_no = '534-52-1922'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.STAT_C='A'
order by dd.mod_ts desc
for fetch only with ur
;
select * from DBREGRC.part_def_data
where
 DEF_A > 0
--soc_sec_no = '539-46-8344'
;

-- sc 4.3  corp
SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
--case_no = 'QK62158LY 00001' and
soc_sec_no = '455-87-2928' --'896-34-5416' --'487-16-2463'
for fetch only with ur;
--join
select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBSYSTC.part_enrl_xref xref, DBSYSTC.part_def_data dd
where xref.account_no = 'QK62158LY 00001' and xref.soc_sec_no = '896-34-5416' --'996-10-9297' -- '487-16-2463'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.STAT_C='A'
order by dd.mod_ts desc
for fetch only with ur
--return  ENRL_PROV_GRP_I and PART_ENRL_I, SRC_I and DEF_GRP_I, DEF_A and DEF_P  of the newest active record
;
select * from DBSYSTC.part_def_data
where DEF_A > 0
;
--get the list of valid remit codes for specific case number
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   
	DBSYSTC.CO_SOURCE CS, 
	DBSYSTC.PLAN_PROV_GRP PPG, 
    DBSYSTC.PLAN_PROVISION PP, 
    DBSYSTC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO = 'JK62197PM 00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;

select * from DBSYSTC.PLAN_SRC_DETAIL PSD
where SRC_I = 30510975058594386 
and SRC_TYP_C = 3
and SRC_S = 6
and DEFAULT_SRC_C = 1
and FORMULA_C = 5
and ACTIVE_SRC_C = 'A'
and REPORT_1_NM = '401(k)'
and REPORT_2_NM = 'Elective'
;


UPDATE DBSYSTC.PLAN_SRC_DETAIL PSD
SET TRANSLATION_C = '6'
WHERE SRC_I = 30510975058594386 
and SRC_TYP_C = 3
and SRC_S = 6
and DEFAULT_SRC_C = 1
and FORMULA_C = 5
and ACTIVE_SRC_C = 'A'
and REPORT_1_NM = '401(k)'
and REPORT_2_NM = 'Elective'
;


select * from DBSYSTC.PLAN_SRC_DETAIL PSD
where SRC_I = 51809085058594386 
and SRC_TYP_C = 4
and SRC_S = 8
and DEFAULT_SRC_C = 1
and FORMULA_C = 1
and ACTIVE_SRC_C = 'A'
and REPORT_1_NM = 'Employer'
and REPORT_2_NM = 'Match'
;

UPDATE DBSYSTC.PLAN_SRC_DETAIL PSD
SET TRANSLATION_C = '8'
WHERE SRC_I = 51809085058594386 
and SRC_TYP_C = 4
and SRC_S = 8
and DEFAULT_SRC_C = 1
and FORMULA_C = 1
and ACTIVE_SRC_C = 'A'
and REPORT_1_NM = 'Employer'
and REPORT_2_NM = 'Match'
;





select *
from DBSYSTC.eds_enrl
where 
soc_sec_no = '896-34-5416' and CASE_NO = 'QK62158LY 00001'
for fetch only with ur;
;
select * from DBSYSTC.part_auto_def
where soc_sec_no = '896-34-5416' --and account_no = 'JK62197PM 00001'
for fetch only with ur;


-- sc 4.2  corp
--returns all CLASS CODE for a PLAN
select * --pc.*
from DBSYSTC.plan_prov_grp pg,
     DBSYSTC.plan_provision pprov,
     DBSYSTC.plan_class pc
where pg.account_no like '%62536%'
and pg.enrl_prov_grp_i = pprov.enrl_prov_grp_i
and pprov.provision_i = pc.class_prov_i
FOR FETCH ONLY
;


--78614338540138387
select *
from DBSYSTC.plan_prov_grp
where account_no like '%62536%'
;
select *
from DBSYSTC.plan_provision
where enrl_prov_grp_I = 78614338540138387
and provision_i in (select class_prov_i from DBSYSTC.plan_class where class_prov_i = provision_i)
;
--plan_class.class_prov_i = plan_provision.provision_i
select *
from DBSYSTC.plan_class
where class_prov_i= 38956378540138387
;


--sc 5.1 to 5.4


SELECT *
from  DBREGRT.EMPLOYEE
WHERE 
soc_sec_no in ( '999-71-1001','999-72-1001','999-73-1001','999-74-1001' )
for fetch only with ur;


SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
EE_DIV_NO = 'D001'
--and  EE_PAYROLL_FREQ_CD = 24
and case_no <> 'JK62130LH 00001'
for fetch only with ur
;
SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
case_no = 'QK62158TR 00001'
--'JK62476TR 00001'
and
soc_sec_no = '027-01-8990' 
--and EE_PAYROLL_FREQ_CD = 26
for fetch only with ur;

--sc 12
SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
case_no = 'QK62158TR 00001' and
--'JK62476TR 00001'
soc_sec_no = '004-70-4500' 
--and EE_PAYROLL_FREQ_CD = 26
for fetch only with ur;


UPDATE DBSYSTC.EMPLOYEE
SET EE_REHIRE_DT = NULL, EE_TERM_DT = '00000000'
WHERE CASE_NO = 'QK62158TR 00001' AND SOC_SEC_NO = '004-70-4500'
;


--sc 13 and 14

SELECT * 
from  DBSYSTC.EMPLOYEE
WHERE 
--CASE_NO ='QK62158TR 00001' and ee_div_no = 'NMI0'
  soc_sec_no in ( '999-99-1003')
--order by soc_sec_no
for fetch only with ur;

SELECT * 
from  DBSYSTC.EDS_ENRL
WHERE 
--CASE_NO ='QK62536MB 00001' 
  soc_sec_no in ('999-99-1002', '999-99-1003')
--order by soc_sec_no
for fetch only with ur;


SELECT *
from  DBSYSTC.eds_load_data
where soc_sec_no = '004-70-4500'
;

--sc 15

SELECT * 
from  DBSYSTC.EMPLOYEE
WHERE 
CASE_NO ='QK62158TR 00001' 
and  soc_sec_no in ('027-01-8990', '026-34-0961')
for fetch only with ur;

SELECT * 
from  DBSYSTC.EDS_ENRL
WHERE 
--CASE_NO ='QK62536MB 00001' 
  soc_sec_no in ('027-01-8990', '026-34-0961')
--order by soc_sec_no
for fetch only with ur;

--sc 16
SELECT * 
from  DBSYSTC.EMPLOYEE
WHERE 
CASE_NO ='QK62158TR 00001' and
--  ee_div_no = 'NMI0'
soc_sec_no = '024-22-0369'
for fetch only with ur;


--sc 19

--returns all CLASS_C for a PLAN
select * --pc.*
from DBSYSTC.plan_prov_grp pg,
     DBSYSTC.plan_provision pprov,
     DBSYSTC.plan_class pc
where pg.account_no like 'QK62158TR %'
and pg.enrl_prov_grp_i = pprov.enrl_prov_grp_i
and pprov.provision_i = pc.class_prov_i
FOR FETCH ONLY
;

--sc 18
UPDATE DBSYSTC.EMPLOYEE
SET EE_FST_MID_NM='JOHNPAUL'
WHERE CASE_NO = 'QK62158TR 00001' AND SOC_SEC_NO = '027-01-8990'

Update DBSYSTC.EMPLOYEE Set EE_FST_MID_NM='JOHNPAUL2' where CASE_NO='QK62158TR 00001' AND SOC_SEC_NO='027-01-8990';


Update DBSYSTC.EMPLOYEE Set EE_LAST_NM='MEENEN' where CASE_NO='QK62158TR 00001' AND SOC_SEC_NO='026-34-0961' 
;


--join
select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBSYSTC.part_enrl_xref xref, DBSYSTC.part_def_data dd
where xref.account_no = 'QK62158TR 00001' and xref.soc_sec_no = '004-70-4500'     --and xref.soc_sec_no = '516-30-6584'--'007-11-8144' --'996-10-9297' -- '487-16-2463'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.DEF_A > 0
--and dd.STAT_C='A'
--order by dd.SOC_SEC_NO, dd.mod_ts desc
order by dd.mod_ts desc
for fetch only with ur
--return  ENRL_PROV_GRP_I and PART_ENRL_I, SRC_I and DEF_GRP_I, DEF_A and DEF_P  of the newest active record
;
--get the list of valid remit codes for specific case number
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   
	DBSYSTC.CO_SOURCE CS, 
	DBSYSTC.PLAN_PROV_GRP PPG, 
    DBSYSTC.PLAN_PROVISION PP, 
    DBSYSTC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO like 'QK62158LY 00001%'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;

SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C     --psd.TRANSLATION_C 
FROM   DBSYSTC.CO_SOURCE CS, 
       DBSYSTC.PLAN_PROV_GRP PPG, 
       DBSYSTC.PLAN_PROVISION PP, 
       DBSYSTC.PLAN_SRC_DETAIL PSD 
WHERE  PSD.TRANSLATION_C like '6%'  --PPG.ACCOUNT_NO ='JK62197PM 00001'  
      AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
      AND PP.PROV_TYP_C = 13 
      AND PP.PROVISION_I = PSD.SRC_I 
      AND PSD.SRC_TYP_C = CS.SRC_TYP_C 
                --AND CS.CTRB_SRC_C = '1'
      AND PSD.ACTIVE_SRC_C IN ('A')
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PLAN_PROVISION;

select *
from DBSYSTC.eds_enrl
where 
soc_sec_no = '896-34-5416' and CASE_NO = 'QK62158LY 00001'
for fetch only with ur;
;
select * from DBSYSTC.part_auto_def
where soc_sec_no = '896-34-5416' --and account_no = 'JK62197PM 00001'
for fetch only with ur;

--sc4.1
SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
case_no = 'QK62158TA 00001'
 and
soc_sec_no = '796-11-4637' 
for fetch only with ur;


--sc 5.2 - 26


SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
case_no = 'JK62197PM 00001'
 and
soc_sec_no = '999-99-9007' 
for fetch only with ur;

--remit
select * from DBSYSTC.BILL_REMIT_DETAIL
where --tr_ref_no like '20180219922225%'
--or  soc_sec_no = '999-99-1005' ;
case_no = 'JK62197PM 00001'
for fetch only with ur;

select * from DBSYSTC.EDS_BILL_REMIT
where soc_sec_no = '999-99-1005' 
for fetch only with ur;
-- result:
--CASE_NO,SOC_SEC_NO,TR_REF_NO,BILL_SUBM_AMT
--JK62197PM 00001,999-99-1005,20180219922225,100.00
--JK62197PM 00001,999-99-1005,20180219922225,200.00

--EDS_ENRL
--EDS_ADDRESS
--EDS_HOURS

--sc 5.3 - 27

SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
case_no = 'JK62197PM 00001'
 and
soc_sec_no in ( '003-31-7251', '043-28-8430' )
for fetch only with ur;


-- remit 6 => SRC_I = 30510975058594386 
-- remit 8 => SRC_I = 51809085058594386 
--remit
select * from DBSYSTC.BILL_REMIT_DETAIL
where --tr_ref_no like '20180219922225%'
case_no = 'JK62197PM 00001'
and soc_sec_no = '003-31-7251' 
and SRC_I = 30510975058594386 
for fetch only with ur;

select * from DBSYSTC.EDS_BILL_REMIT
where soc_sec_no in ( '003-31-7251', '043-28-8430' )
order by mod_ts desc
for fetch only with ur;


--sc 6.1 - sc 28

select *
from DBSYSTC.plan_prov_grp
where (account_no like 'PE61743%'  or account_no like 'QK62302DL %')
and CONV_STAT_C <> 0
;
--PE61743DB 00001

--clas code
select * --pc.*
from DBSYSTC.plan_prov_grp pg,
     DBSYSTC.plan_provision pprov,
     DBSYSTC.plan_class pc
where pg.account_no like 'QK62158LY%'-- 'PE61743DB%'
and pg.enrl_prov_grp_i = pprov.enrl_prov_grp_i
and pprov.provision_i = pc.class_prov_i
FOR FETCH ONLY
;


--clas code - regression
select * --pc.*
from DBREGRC.plan_prov_grp pg,
     DBREGRC.plan_provision pprov,
     DBREGRC.plan_class pc
where pg.account_no like 'PE61743MB%'-- 'PE61743DB%'
and pg.enrl_prov_grp_i = pprov.enrl_prov_grp_i
and pprov.provision_i = pc.class_prov_i
FOR FETCH ONLY
;


select *
from DBSYSTC.plan_prov_grp pgrp
where pgrp.account_no like 'JK62202MB%'
and pgrp.enrl_prov_grp_I in (select enrl_prov_grp_i from DBSYSTC.part_def_data where enrl_prov_grp_i = pgrp.enrl_prov_grp_i)
for fetch only with ur;

SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
--case_no = 'PE61743DB 00001' and class_i = 0
soc_sec_no in ( '999-99-1007',  '999-99-1008')
for fetch only with ur;


SELECT *
from  DBREGRC.EMPLOYEE
WHERE 
--case_no = 'PE61743DB 00001' and class_i = 0
soc_sec_no = '999-99-1003'
for fetch only with ur;

--sc 7.1 to 7.4  - 31 to 34

select *
from DBSYSTC.plan_prov_grp
where (account_no like '%62302%'  or account_no like '%62343%' or account_no like '%62329%' or account_no like '%080313%')
and RELATED_GRP_TYP_C = 361
and TAKEOVER_CARRIER_IND_C = 0
;

SELECT *
from  DBSYSTC.EMPLOYEE
WHERE 
soc_sec_no in ('999-71-1001', '999-72-1001', '999-73-1001', '999-74-1001')
for fetch only with ur;

select *
from DBREGRC.plan_prov_grp
where (account_no like 'QK62302DL%'  or account_no like 'QK62343DB%' or account_no like 'JK62329RW%' or account_no like 'TT080313MB%')
;

SELECT *
from  DBREGRC.EMPLOYEE
WHERE 
--case_no = 'PE61743DB 00001' and class_i = 0
soc_sec_no in ('999-71-1001', '999-72-1001', '999-73-1001', '999-74-1001')
for fetch only with ur;

select *
from DBREGRC.eds_enrl
where 
soc_sec_no in ('999-71-1001', '999-72-1001', '999-73-1001', '999-74-1001')
for fetch only with ur;
;

--sc 34


SELECT *
from  DBSYSTC.PART_PPA_DEFAULT
WHERE ACCOUNT_NO = '932256    00004' and SOC_SEC_NO = '976-11-2157'
--932256    00004,976-11-2157
--ENRL_PROV_GRP_I,PART_ENRL_I
--1045558123494,624928233818946
;

SELECT *
from  DBSYSTC.PART_PPA_DEFAULT PD, DBSYSTC.PART_ELECT_DETAIL EDT
WHERE PD.account_no = '651744RT  00001' --and PD.soc_sec_no = '976-11-2157'
and  PD.ENRL_PROV_GRP_I = EDT.ENRL_PROV_GRP_I
and  PD.PART_ENRL_I = EDT.PART_ENRL_I 
;

--sc 10.1

select *
from DBSYSTC.plan_prov_grp
where (account_no like 'TT069090%' )
and RELATED_GRP_TYP_C = 361
and TAKEOVER_CARRIER_IND_C = 0
;

--clas code - corp
select * --pc.*
from DBSYSTC.plan_prov_grp pg,
     DBSYSTC.plan_provision pprov,
     DBSYSTC.plan_class pc
where pg.account_no like 'TT069090%'
and pg.enrl_prov_grp_i = pprov.enrl_prov_grp_i
and pprov.provision_i = pc.class_prov_i
FOR FETCH ONLY
;


SELECT *
from   DBSYSTC.EMPLOYEE
WHERE 
case_no like 'TT069090TA%' 
order by mod_ts desc;

SELECT *
from   DBSYSTC.EMPLOYEE
WHERE 
ALT_TERM_REASON_CD <> ''
for fetch only with ur;

SELECT *
from  DBSYSTC.EMPLOYEE
WHERE ee_div_no = '4002' 
--case_no like 'TT0690%' 
--soc_sec_no in  ('002-52-1239') --('002-52-1239', '002-62-4773', '003-60-4711', '004-44-7746')
for fetch only with ur;

--ALT_TERM_REASON_CD values
SELECT * 
FROM DBSYSTC.HELPER2
WHERE HLP_CODE = 'ALTTERMR'
FOR FETCH ONLY WITH UR; 

-----------

--join
select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBSYSTC.part_enrl_xref xref, DBSYSTC.part_def_data dd
where xref.account_no = 'QK62158TA 00001' and xref.soc_sec_no = '796-11-4637' -- '516-30-6584'--'007-11-8144' --'996-10-9297' -- '487-16-2463'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.DEF_P > 0
--and dd.STAT_C='A'
--order by dd.SOC_SEC_NO, dd.mod_ts desc
order by dd.STAT_C, dd.mod_ts desc
for fetch only with ur
;

--corp
select * from DBSYSTC.plan_class
where 
CLASS_C like 'SUMMER%'
or CLASS_C like 'SUBSID%'
or CLASS_C like 'RNS%'
--and CLASS_C like 'OWNS%'
--and CLASS_C like 'NONRES%'
--and CLASS_C like 'LEASED%'
--and CLASS_C like 'INTERN%'
or CLASS_C like 'IND CONT%'
--and CLASS_C like 'DIR%'
--and CLASS_C like 'COOP%'
--and CLASS_C like 'COBAR%'
--and CLASS_C like 'CIG%'
--and CLASS_C like 'AFFIL%'
order by class_prov_i
for fetch only with ur; 



--************************************************************************************


SELECT * FROM DBREGRC.EDS_LOAD_DATA
;

Select * from DBSYSTC.EDS_LOAD_DATA 
order by mod_ts desc
for fetch only;

WHERE DATA_ACT_FILE_I=80317715195469070

SELECT * FROM DBREGRC.EDS_LOAD_MAP
;

SELECT * from DBREGRC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (79229803318743500)
for fetch only;

--corp test

--sc4.3

select * from DBSYSTC.EMPLOYEE
where 
case_no = 'QK62158TR 00001'
and soc_sec_no in ('026-34-0961', '046-09-5987')
for fetch only;

select xref.ACCOUNT_NO, xref.SOC_SEC_NO, dd.ENRL_PROV_GRP_I, dd.PART_ENRL_I, dd.SRC_I, dd.DEF_GRP_I, dd.DEF_A, dd.DEF_P, dd.STAT_C, dd.DATA_CH_ORIG_C, dd.TRANSMIT_C, dd.EFF_D, dd.MOD_TS 
from DBSYSTC.part_enrl_xref xref, DBSYSTC.part_def_data dd
where xref.account_no = 'QK62158LY 00001' and xref.soc_sec_no = '896-34-5416' -- '516-30-6584'--'007-11-8144' --'996-10-9297' -- '487-16-2463'
and xref.ENRL_PROV_GRP_I = dd.ENRL_PROV_GRP_I
and xref.PART_ENRL_I = dd.PART_ENRL_I
--and dd.DEF_P > 0
--and dd.STAT_C='A'
--order by dd.SOC_SEC_NO, dd.mod_ts desc
order by dd.STAT_C, dd.mod_ts desc
for fetch only with ur;


--sc 4.4  --'999-99-1003', '003-62-3867')

--sc 5.2 - 26
select *--CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
soc_sec_no in ('999-99-1005', '999-99-1006', '999-99-1007')
for fetch only;

select *
from DBSYSTC.EDS_ENRL
where soc_sec_no in ('999-99-1005')
for fetch only;


select *
from DBSYSTC.EE_BEN_ADDRES
where soc_sec_no in ('999-99-1005')
for fetch only;


select *
from DBSYSTC.EE_HRS_WORKED
where soc_sec_no in ('999-99-1005') and case_no = 'JK62197PM 00001'
for fetch only;


select *
from DBSYSTC.BILL_REMIT_DETAIL
where soc_sec_no in ('999-99-1005')
 and case_no = 'JK62197PM 00001'
for fetch only;


select *
from DBSYSTC.EDS_ENRL
where soc_sec_no in ('999-99-1005')
for fetch only;


select *
from DBSYSTC.EDS_ADDRESS
where soc_sec_no in ('999-99-1005') and case_no = 'JK62197PM 00001'
for fetch only;


select *
from DBSYSTC.EDS_HOURS
where soc_sec_no in ('999-99-1005')
for fetch only;


select *
from DBSYSTC.EDS_BILL_REMIT
where soc_sec_no in ('999-99-1005')
for fetch only;




--test corp
SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO in ('TT080313MB 00001','TT069112MB 00001','TT069202DB 00001','TT069071MB 00001','QK62165MB 00001','QK62027MB 00001','QK61855MB 00001','QK61440MB 00001','JK62197DB 00001','QK62132MB 00001')
;

--test corp
select * from DBSYSTC.PLAN_PROV_GRP
where account_no in ('QK62158LY 00001')
--('TT080313MB 00001','TT069112MB 00001','TT069202DB 00001','TT069071MB 00001','QK62165MB 00001','QK62027MB 00001','QK61855MB 00001','QK61440MB 00001','JK62197DB 00001','QK62132MB 00001')
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PLAN_PROV_GRP
where account_no like '%62202%'
FOR FETCH ONLY WITH UR;

SELECT *
FROM DBSYSTC.PLAN_CLASS
WHERE CLASS_I=91855506081903125 --9320646235960500; 
;


--CORP plan
SELECT * 
--CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRC.EMPLOYEE
WHERE SOC_SEC_NO = '148-56-1982'
FOR FETCH ONLY WITH UR;

---------- TDA plans
SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBREGRT.EMPLOYEE
WHERE 
--CASE_NO like 'TT069112MB%'
 SOC_SEC_NO like '003-60-4711%'
FOR FETCH ONLY WITH UR;


--get the list of valid remit codes for specific case number
SELECT psd.TRANSLATION_C 
FROM   DBREGRC.CO_SOURCE CS, 
       DBREGRC.PLAN_PROV_GRP PPG, 
       DBREGRC.PLAN_PROVISION PP, 
       DBREGRC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='QK62158MB 00001'  
      AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
      AND PP.PROV_TYP_C = 13 
      AND PP.PROVISION_I = PSD.SRC_I 
      AND PSD.SRC_TYP_C = CS.SRC_TYP_C 
                --AND CS.CTRB_SRC_C = '1'
      AND PSD.ACTIVE_SRC_C IN ('A')
FOR FETCH ONLY WITH UR;
--
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   
	DBREGRC.CO_SOURCE CS, 
	DBREGRC.PLAN_PROV_GRP PPG, 
    DBREGRC.PLAN_PROVISION PP, 
    DBREGRC.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO like 'QK62158MB 00001%'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;


-- ####################    LOAD DATA in REGRESSION   *******************************************

select max(DATA_ACT_FILE_I)+1 as DATA_ACT_FILE_I
from DBREGRP.EDS_LOAD_MAP
WITH UR FOR FETCH ONLY;

INSERT INTO DBREGRP.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (84829831512174503
, '7'
, 'sc-1-5_84829831512174502.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2018-05-04-12.37.00.091195'
, '', '0', '0', '0', '0' );


select * from DBREGRP.EDS_LOAD_MAP
order by mod_ts desc;


select * from dbregrp.EDS_LOAD_MAP
order by mod_ts desc;


--get the layout file name and
select FILE_NM, DATA_ACT_FILE_I, MOD_TS from DBREGRC.EDS_LOAD_MAP
where file_nm like 'SCENARIO1_1_%' --'SCENARIO1_1_1512650555043.XLS' 
order by mod_ts desc
;   


select * from DBREGRP.EDS_LOAD_MAP
--WHERE DATA_ACT_FILE_I in (100000013)
for fetch only;


select * from DBREGRP.EDS_load_data; 



INSERT INTO DBREGRP.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(84829831512174503
,84829831512174503
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2018-05-04-12.37.00.091195'
);


select * from DBREGRP.EDS_load_map
order by mod_ts desc;

SELECT * from DBREGRP.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (97248545735284501)
for fetch only;

SELECT * from DBREGRP.EDS_BATCH_QUEUE
order by mod_ts desc
for fetch only;

SELECT * from DBREGRC.employee
where soc_sec_no = '999-88-8815'

-- ****************************************************************



--//////   LOAD DATA    SYSTC

--var = 51149990257770926

INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257771025
, '7'
, 'enrol1_651660_51149990257771025.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-11-14-11.22.00.091195'
, '', '0', '0', '0', '0' );


select * from DBSYSTC.EDS_LOAD_MAP
where DATA_ACT_FILE_I= 99998909738563532
;

--get the layout file name and
select * --FILE_NM, DATA_ACT_FILE_I, MOD_TS 
from DBREGRP.EDS_LOAD_MAP
--where file_nm like 'SCENARIO1_1_%' --'SCENARIO1_1_1512650555043.XLS' 
order by mod_ts desc
;   

select * from DBREGRC.EDS_LOAD_map_detl
 where DATA_ACT_FILE_I = 59107100559684509;

select * from DBREGRT.EDS_load_data 
where DATA_ACT_FILE_I = 59107100559684509;



select * from DBREGRP.EDS_load_data_msg where DATA_ACT_FILE_I = 59107100559684509;

--does not exist in DB2 reg
--select * from DBREGRC.EDS_eds_load_data_m_h where DATA_ACT_FILE_I = 59107100559684509


--TEST CORP
select * from DBSYSTC.EDS_LOAD_MAP
WHERE 
DATA_ACT_FILE_I in (59107100559684509)
for fetch only;


select * from DBSYSTC.EDS_LOAD_MAP
WHERE DATA_ACT_FILE_I in (99998909738563539)
;

select msg.EDS_DATA_MSG, lm.FILE_NM, lm.DATA_ACT_FILE_I, lm.MOD_TS, bq.STAT_C, bq.START_TS, msg.DATA_ACT_FILE_I, msg.SOC_SEC_NO, msg.MOD_TS 
from   DBSYSTC.EDS_LOAD_MAP lm, DBSYSTC.EDS_BATCH_QUEUE bq, DBSYSTC.EDS_LOAD_DATA_MSG msg
where  lm.file_nm = 'EDSSC015_1518114307553_99998909738563540.TXT' 
   and lm.DATA_ACT_FILE_I = bq.DATA_ACT_FILE_I
   and lm.DATA_ACT_FILE_I = msg.DATA_ACT_FILE_I
;

select DISTINCT (msg.EDS_DATA_MSG)
from   DBSYSTC.EDS_LOAD_MAP lm, DBSYSTC.EDS_BATCH_QUEUE bq, DBSYSTC.EDS_LOAD_DATA_MSG msg
where  lm.file_nm = 'EDSSC015_1518114307553_99998909738563540.TXT'
   and lm.DATA_ACT_FILE_I = bq.DATA_ACT_FILE_I
   and lm.DATA_ACT_FILE_I = msg.DATA_ACT_FILE_I
;


select *
from   DBSYSTC.EDS_LOAD_MAP lm, DBSYSTC.EDS_BATCH_QUEUE bq, DBSYSTC.EDS_LOAD_DATA_MSG msg
where  lm.file_nm = 'EDSSC015_1518114307553_99998909738563540.TXT' 
   and lm.DATA_ACT_FILE_I = bq.DATA_ACT_FILE_I
   and lm.DATA_ACT_FILE_I = msg.DATA_ACT_FILE_I
;



INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257771025
,51149990257771025
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-11-14-11.22.00.091195'
);


SELECT * from DBREGRP.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (9771026228405550)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257771025 AND DATA_ACT_FILE_I=51149990257771025;


select max(DATA_ACT_FILE_I)+1 as DATA_ACT_FILE_I
from DBSYSTC.EDS_LOAD_MAP
WITH UR FOR FETCH ONLY;


-- *****************************************
select * from dbsystc.plan_class 
where class_i in 
    (select class_i 
     from dbsystc.class_prov_xref 
     where provision_i in (select provision_i from dbsystc.plan_provision where enrl_prov_grp_i in( (select enrl_prov_grp_i from dbsystc.plan_prov_grp where account_no='651658    00001') )))
for fetch only with ur;

SELECT E.CASE_NO,e.SOC_SEC_NO,e.STAT_C,e.ENRL_TYP_C,e.EE_FST_MID_NM,e.EE_LAST_NM,e.EE_HIRE_D,e.EE_BRTH_D,e.INVESTOR_TYP_C,e.CLASS_I, p.PART_ENRL_I,p.ENRL_EFF_D,p.ENRL_STAT_C,p.INVESTOR_TYP_C
from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = 'Q51576    00001' and e.soc_sec_no in ('888-77-0083') --, '888-77-0081', '888-77-0082', '888-77-0083')
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;


--get the layout file name and data_act_file
select FILE_NM, DATA_ACT_FILE_I, MOD_TS from DBSYSTC.EDS_LOAD_MAP
where file_nm = 'SCENARIO1_1_1513110130583.XLS' --'SCENARIO1_1_1512650555043.XLS' 
order by mod_ts desc
;   

select DATA_ACT_FILE_I, EDS_DATA_MSG, MOD_TS from DBSYSTC.EDS_LOAD_DATA_MSG;


--final query
select lm.FILE_NM, lm.DATA_ACT_FILE_I, lm.MOD_TS, bq.STAT_C, bq.START_TS, msg.DATA_ACT_FILE_I, msg.SOC_SEC_NO, msg.EDS_DATA_MSG, msg.MOD_TS 
from DBSYSTC.EDS_LOAD_MAP lm, DBSYSTC.EDS_BATCH_QUEUE bq, DBSYSTC.EDS_LOAD_DATA_MSG msg
where lm.file_nm like 'CAMPBELL_NEWFORALL_22353_1513123109110.TXT%' --'SCENARIO1_1_1513110130583.XLS'
      and lm.DATA_ACT_FILE_I = bq.DATA_ACT_FILE_I
      and lm.DATA_ACT_FILE_I = msg.DATA_ACT_FILE_I
FOR FETCH ONLY WITH ur
; 




-------------------- ######################################################################################


SELECT PLAN_ENRL_I
,ENRL_PROV_GRP_I
,ACCOUNT_NO
,TAKEOVER_CARRIER_IND_C
,PROV_GRP_SRCH_NM
,PROV_GRP_DESC_T
,RELATED_GRP_TYP_C
FROM DBSYSTC.PLAN_PROV_GRP
WHERE 
ACCOUNT_NO like '%62536%'
--AND TAKEOVER_CARRIER_IND_C = 1 --Mercer
AND TAKEOVER_CARRIER_IND_C = 0 --TA
--AND PROV_GRP_DESC_T like 'DEFAULT CARVE OUT GROUP%'
;

SELECT *
FROM DBSYSTC.PLAN_PROV_GRP
WHERE 
--ACCOUNT_NO = 'Q51215    00001'
--AND TAKEOVER_CARRIER_IND_C = 1 --Mercer
TAKEOVER_CARRIER_IND_C = 0 --TA
AND RELATED_GRP_TYP_C = 361
AND PROV_GRP_DESC_T like 'DEFAULT CARVE OUT GROUP%'
AND PROV_GRP_SRCH_NM like '%INCYTE%'
;

--
--PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T,RELATED_GRP_TYP_C
--62679982143344729,42092143344729,QK62963PB 00001,0,DURO HILEX POLY, LLC ARIZONA HOURLY EMPLOYEES 401(K) PLAN,DEFAULT CARVE OUT GROUP UNDER THIS PLAN,361

--sc9-reg
--PLAN_ENRL_I,ENRL_PROV_GRP_I,DFLT_GRP_C,RELATED_GRP_I,RELATED_GRP_TYP_C,PROV_GRP_SRCH_NM,ACCOUNT_NO,BUS_LINE_C,ENRL_STAT_C,CONV_STAT_C,CONV_D,CREATION_USER_I,CREATION_TS,PROV_GRP_RSN_C,REL_C,PROV_GRP_OPT_C,PROV_GRP_DESC_T,USER_I,MOD_TS,TAKEOVER_CARRIER_IND_C,TAKEOVER_CARRIER_TYP_C,EMPLOYER_ID,CLIENT_ID
--86229023238594100,21673123238594100,1,0,361,INCYTE CORPORATION 401(K) PLAN,JK62197DB 00001,2,7,0,NULL,,2005-09-28-06.55.27.114000,,0,,DEFAULT CARVE OUT GROUP UNDER THIS PLAN,UTILVIXP,2009-03-23-10.59.50.671000,0,0,,


--SC9- test
--PLAN_ENRL_I,ENRL_PROV_GRP_I,DFLT_GRP_C,RELATED_GRP_I,RELATED_GRP_TYP_C,PROV_GRP_SRCH_NM,ACCOUNT_NO,BUS_LINE_C,ENRL_STAT_C,CONV_STAT_C,CONV_D,CREATION_USER_I,CREATION_TS,PROV_GRP_RSN_C,--REL_C,PROV_GRP_OPT_C,PROV_GRP_DESC_T,USER_I,MOD_TS,TAKEOVER_CARRIER_IND_C,TAKEOVER_CARRIER_TYP_C,EMPLOYER_ID,CLIENT_ID
--86229023238594386,21673123238594386,1,0,361,INCYTE CORPORATION 401(K) PLAN,JK62197PM 00001,2,7,0,NULL,,2005-09-28-06.55.27.114000,,0,,DEFAULT CARVE OUT GROUP UNDER THIS PLAN,UYS108,2016-11-30-19.32.25.034313,0,0,,


select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,CLASS_I,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
--case_no like 'JK62150FC%'  and ee_div_no like 'D%'
soc_sec_no in ('999-99-9912', '999-99-9913', '999-99-1000', '999-99-1001')
WITH UR FOR FETCH ONLY; 


--------------------------------------


-------   PA-OW automation - SC01 and SC02
--QK61975MB 00001   - DONALD J. FAGER & ASSOCIATES, 401(k 
--QK62471MB 00001   - REHABCARE GROUP, INC
--TT080304MB 00001   - PROC SECIVRES HTLAEH TSIDOHTEM

---DDOL/VRU
--1.	Terminations set to Non-outsourced and DDOL/VRU tab Term withdrawals set to Allow Request.
SELECT *--pw.WD_ONLINE_C 
FROM DBREGRC.PLAN_WITHDRAWAL pw 
WHERE pw.WD_ONLINE_C = '2' 
--and plan_wd_prov_i = 94421489346536000
for FETCH ONLY WITH UR; 


SELECT PPG.account_no, PW.*
FROM DBREGRC.plan_prov_grp PPG
JOIN DBREGRC.plan_provision PP ON PP.enrl_prov_grp_i = PPG.enrl_prov_grp_i
JOIN DBREGRC.plan_withdrawal PW ON PP.provision_i = PW.plan_wd_prov_i
WHERE PW.wd_online_c = '2' 
FOR FETCH ONLY WITH UR; 



-- Vesting
--2.	Vesting set to Plan Admin PSOL.
SELECT *--gvd.APP_C 
FROM DBREGRC.GEN_VESTING_DATA gvd 
WHERE gvd.APP_C = 2 
--and vest_i = '32044042311440400'
FOR FETCH ONLY WITH UR; 

--plan_wd_prov_i = 32044042311440400



-- QUERY 2

SELECT PPG.account_no, gvd.*
FROM DBREGRC.plan_prov_grp PPG
JOIN DBREGRC.plan_provision PP ON PP.enrl_prov_grp_i = PPG.enrl_prov_grp_i
JOIN DBREGRC.GEN_VESTING_DATA gvd ON PP.provision_i = gvd.vest_i
WHERE gvd.APP_C = 2 
--and vest_i = '32044042311440400'
FOR FETCH ONLY WITH UR; 


-- QUERY 3

SELECT PPG.account_no, otr.*
FROM DBREGRC.plan_prov_grp PPG
JOIN DBREGRC.plan_provision PP ON PP.enrl_prov_grp_i = PPG.enrl_prov_grp_i
JOIN DBREGRC.OUTSRC_TERM_RULES OTR ON pp.provision_i = otr.outsrc_i
WHERE otr.NON_OUT_APP_METH = '2' 
for FETCH ONLY WITH UR;



-- 3.	In P3 -> outsourcing tab
SELECT *--otr.NON_OUT_APP_METH 
FROM DBREGRC.OUTSRC_TERM_RULES OTR 
WHERE otr.NON_OUT_APP_METH = '2' 
for FETCH ONLY WITH UR;
--returned 2 rows:
-- OUTSRC_I,EFF_D
-- 62316393242031200,0001-02-01
-- 83655247702765000,0001-02-01

--find the account number for the outsrc_i = 83655247702765000
SELECT ACCOUNT_NO, PROVISION_I 
FROM DBREGRC.PLAN_PROVISION PP, 
     DBREGRC.PLAN_PROV_GRP PPG 
WHERE PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
   AND PROVISION_I = 16423696243765000-- 83655247702765000
;
--Returned: ACCOUNT_NO,PROVISION_I
--TT069026MB00001,83655247702765000

--find the account number for the outsrc_i = 62316393242031200
SELECT ACCOUNT_NO, PROVISION_I 
FROM DBREGRC.PLAN_PROVISION PP, 
     DBREGRC.PLAN_PROV_GRP PPG 
WHERE PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
   AND PROVISION_I = 62316393242031200;
--Returned: ACCOUNT_NO,PROVISION_I
--         TT080304MB00001,62316393242031200


SELECT *
FROM DBREGRC.OUTSRC_ELIG_SRC OES,DBREGRC.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I) IN (SELECT ACCOUNT_NO, PROVISION_I FROM DBREGRC.PLAN_PROVISION PP, DBREGRC.PLAN_PROV_GRP PPG WHERE ACCOUNT_NO IN ('QK61975MB 00001') AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I)
--AND OES.SERV_LEV_C = 3
FOR FETCH ONLY WITH UR;
 
SELECT *
FROM DBREGRC.OUTSRC_ELIG_SRC OES,DBREGRC.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I) IN (SELECT ACCOUNT_NO, PROVISION_I FROM DBREGRC.PLAN_PROVISION PP, DBREGRC.PLAN_PROV_GRP PPG WHERE ACCOUNT_NO IN ('QK61975MB 00001') AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I)
--AND OES.SERV_LEV_C = 3
FOR FETCH ONLY WITH UR;

SELECT ACCOUNT_NO, PROVISION_I 
FROM DBREGRC.PLAN_PROVISION PP, 
     DBREGRC.PLAN_PROV_GRP PPG 
WHERE ACCOUNT_NO IN ('QK61975MB 00001') 
   AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
   --AND PP.PROV_TYP_C = 80

-------**************************************                  END -   PA-OW automation - SC01 and SC02


Insert into DBREGRP.EDS_LOAD_MAP (DATA_ACT_FILE_I, MAP_TYP_C, FILE_NM, ACCOUNT_NO, FILE_TYP_C, SKIP_ROW_NO, HEADER_ROW_C, ORIG_MAP_DESC_T, CONTROL_MAP_DETL_T, EDS_NOTES_T, EDS_DATA_MESG_T, USER_I, MOD_TS, SERVICER_CD, AWD_FLAG_C, VALIDATE_FLAG_C, IS_CASH_CONV_C, DISC_TESTING_FLAG_C, CLIENT_FILE_ID) 
VALUES(9771026228405500, '1', 'SCENARIO1_5_1528807461111.XLS', 'QK62165MB 00001', '2', 1, '', 'ENROLLMENT', '', '', '', 'DEVELOPER', '2018-06-12-07.44.22.052280', 'SBSWCRJKRE', '0', '0', '0', '0', 0)


Insert into DBREGRP.EDS_BATCH_QUEUE (BATCH_QUEUE_I, DATA_ACT_FILE_I, ENRL_PROV_GRP_I, DATA_TYP_I, LE_I, LOAD_TYP_C, STAT_C, START_TS, END_TS, USER_I, MOD_TS, DEADLOCK_CT, STAGE1_BEGIN_TS, STAGE1_END_TS, STAGE2_BEGIN_TS, STAGE2_END_TS, STAGE3_BEGIN_TS, STAGE3_END_TS, JVM_BATCH_NO, VEST_YEAR_HRS_NO, VEST_YEAR_SERV_C, RELOAD_FLAG_C, TOLERANCE_FLAG_C, USER_EMAIL, IGNORE_FLAG_C) VALUES(11912126228405500, 9771026228405500, 84433052977253100, 80317715195469088, 84433052977253100, '1', 6, '2018-06-12-07.44.22.128319', '2018-06-12-07.44.22.128319', 'DEVELOPER', '2018-06-12-07.47.20.329766', 0, '2018-06-12-07.47.03.452000', '2018-06-12-07.47.04.529000', '2018-06-12-07.47.10.316000', '2018-06-12-07.47.14.668000', '2018-06-12-07.47.20.409000', '2018-06-12-07.47.22.187000', 18540, 0, '', '0', '0', '', '0')


