
--var = 51149990257771076

INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (99998909738563302 
, '7'
, 'AUTO_99998909738563302.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2018-01-11-14.45.00.091195'
, '', '0', '0', '0', '0' );


select * from DBSYSTC.EDS_LOAD_MAP
order by mod_ts desc;



--get the layout file name and
select FILE_NM, DATA_ACT_FILE_I, MOD_TS from DBSYSTC.EDS_LOAD_MAP
where file_nm like 'SCENARIO1_1_%' --'SCENARIO1_1_1512650555043.XLS' 
order by mod_ts desc
;   

select * from DBSYSTC.EDS_LOAD_map_detl where DATA_ACT_FILE_I = 35683455712343500;

select * from DBSYSTC.EDS_load_data where DATA_ACT_FILE_I = 35683455712343500;

select * from DBSYSTC.EDS_load_data_msg where DATA_ACT_FILE_I = 51149990257771053
--select * from DBSYSTC.EDS_eds_load_data_m_h where DATA_ACT_FILE_I = 35683455712343500
;

select * from DBSYSTC.EDS_LOAD_MAP
WHERE 
DATA_ACT_FILE_I in (99998909738563305)
for fetch only;


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(99998909738563302
,99998909738563302
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2018-01-11-14.45.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (99998909738563306);



SELECT STAT_C from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I = 99998909738563309;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257771076 AND DATA_ACT_FILE_I=51149990257771076;


SELECT * from DBSYSTC.EDS_BATCH_QUEUE BQ, DBSYSTC.EDS_load_data_msg DM
WHERE 
BQ.DATA_ACT_FILE_I in (99998909738563309)
and DM.DATA_ACT_FILE_I = BQ.DATA_ACT_FILE_I
for fetch only;

select * from DBSYSTC.EDS_load_data_msg where DATA_ACT_FILE_I = 99998909738563309 ;--51149990257771055;

select * from DBSYSTC.EDS_load_data_msg where soc_sec_no = '005-47-8887';



-- ################## *************************************************************  AEGON TEST


INSERT INTO DBSYSTK.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770913
, '7'
, '.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-12-28-07.20.00.091195'
, '', '0', '0', '0', '0' );

SELECT * from DBSYSTK.EDS_LOAD_MAP
WHERE DATA_ACT_FILE_I in (51149990257770901) --(51149990257770873)
for fetch only;


INSERT INTO DBSYSTK.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770913
,51149990257770913
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-12-28-07.20.00.091195'
);


SELECT * from DBSYSTK.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in  (51149990257770913)
order by mod_ts desc
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTK.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770912 AND DATA_ACT_FILE_I=51149990257770912;
 


