--Mercer plans can be identified when takeover_carrier_ind_c is equal to 1:

SELECT PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T, RELATED_GRP_TYP_C
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO like '651736PD%' -- 'Q51479    00001';
--Mercer plans can be identified when takeover_carrier_ind_c is equal to 1:
;

SELECT *
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO = '752319    00001'--= '651479    00001'
;

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO ='651479    00001' AND soc_sec_no in ('888-88-6515', '888-88-6520')
order by soc_sec_no
for fetch only;


SELECT  *
FROM  DBSYSTC.EMPLOYEE
where  --soc_sec_no like '888-66%'--in ('793-27-4921')
ALT_PART_STAT_CD = '00'
order by MOD_TS desc
fetch first 1000 rows only;

SELECT *
FROM DBSYSTC.PLAN_CLASS
where class_i = 86764607775861487
WHERE CLASS_C='1234';
--fetch first 10 rows only;

SELECT *
FROM DBSYSTC.PLAN_CLASS
WHERE CLASS_I=9320646235960500; 
--CLASS_I=9320646235960500;
--CLASS_PROV_I=82707475353350500 and


SELECT PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO = 'S52333    00001';





SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO ='S52333    00001' AND soc_sec_no in ('200-30-4019', '200-30-4020')
order by soc_sec_no
for fetch only;
--class_ = 28628107213670827



-- IT-108801 -----------------------------------------------------------------------------------

SELECT PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO = 'A50878    00001';

SELECT *
from  DBSYSTC.PERSON_HIST
WHERE ACCOUNT_NO ='S52333    00001' AND soc_sec_no in ('200-30-4019', '200-30-4020')
--order by soc_sec_no
--fetch first 10 rows only;
for fetch only;


SELECT *
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO ='A50878    00001' AND soc_sec_no in ('556-60-5115')
--order by soc_sec_no
for fetch only;

SELECT EE.CASE_NO, EE.SOC_SEC_NO, EE.ALT_TERM_REASON_CD, EE.EE_FST_MID_NM,  EE.EE_LAST_NM, EE.EE_HIRE_DT, EE.EE_BRTH_DT, EE.EE_TERM_DT, EE.PART_STAT_CD, EE.ALT_PART_STAT_CD, EE.EE_LOCATION, EE.EE_SUB_LOCATION, EE.EE_DIV_NO, PC.CLASS_I
FROM DBSYSTC.EMPLOYEE EE, DBSYSTC.PLAN_CLASS PC
WHERE EE.CASE_NO = 'A50878    00001' AND EE.SOC_SEC_NO in ('556-60-5115') AND EE.CLASS_I = PC.CLASS_I
For fetch only;
--9320646235960500

SELECT * --PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO in ('651643    00001', 'Q51643    00001');

SELECT PLANP.ENRL_PROV_GRP_I, PLANP.ACCOUNT_NO, PLANP.TAKEOVER_CARRIER_IND_C, PLANP.PROV_GRP_SRCH_NM, PLANP.PROV_GRP_DESC_T, EE.SOC_SEC_NO, EE.ALT_TERM_REASON_CD, EE.EE_FST_MID_NM,  EE.EE_LAST_NM, EE.EE_HIRE_DT, EE.EE_BRTH_DT, EE.EE_TERM_DT, EE.PART_STAT_CD, EE.ALT_PART_STAT_CD, EE.EE_LOCATION, EE.EE_SUB_LOCATION, EE.EE_DIV_NO, PC.CLASS_I, PC.CLASS_C
FROM DBSYSTC.PLAN_PROV_GRP PLANP, DBSYSTC.EMPLOYEE EE, DBSYSTC.PLAN_CLASS PC
WHERE PLANP.ACCOUNT_NO = 'A50878    00001' 
AND PLANP.ACCOUNT_NO = EE.CASE_NO
AND EE.SOC_SEC_NO in ('556-60-5115') 
AND EE.CLASS_I = PC.CLASS_I
For fetch only;


SELECT *
from  DBSYSTC.PERSON_HIST
WHERE ACCOUNT_NO ='A50878    00001' AND soc_sec_no like '%556-60-%'
for fetch only;


select * from DBSYSTC.PLAN_DATA_XREF
where enrl_prov_grp_i=3638105353350500;


select * from DBSYSTC.PLAN_DATA_XREF
where enrl_prov_grp_i=3638105353350500;
--82707475353350500;
--3638105353350500 for A50878   00001
--97885356213670827 for S52333    00001
--fetch first 10 rows only;

select * from dbsystc.helper2
where hlp_code like '%APRTSTAT%';

--list of code for employee.ALT_PART_STAT_CD
select * from DBSYSTP.VHELPER2 where hlp_code='APRTSTAT' ;
----------------------------------------------------



-- check if this data_act_file exists
SELECT * FROM DBSYSTC.EDS_LOAD_MAP
WHERE DATA_ACT_FILE_I in (51149990257770810)
ORDER BY MOD_TS DESC 
--FETCH FIRST 20 ROWS ONLY    
FOR FETCH ONLY WITH UR;

-- if it does not exist then add it
	INSERT INTO DBSYSTC.EDS_LOAD_MAP (
	DATA_ACT_FILE_I
	, MAP_TYP_C
	, FILE_NM
	, ACCOUNT_NO
	, FILE_TYP_C
	, SKIP_ROW_NO
	, HEADER_ROW_C
	, ORIG_MAP_DESC_T
	, CONTROL_MAP_DETL_T
	, EDS_NOTES_T
	, EDS_DATA_MESG_T
	, USER_I
	, MOD_TS
	, SERVICER_CD
	, AWD_FLAG_C
	, VALIDATE_FLAG_C
	, IS_CASH_CONV_C
	, DISC_TESTING_FLAG_C) 
	values (51149990257770810
	, '7'
	, 'donegal_classcode_66654443211100144.txt'
	, 'GENERICEDB00001'
	, '6', 1, ''
	, 'KEY_VALUE_LAYOUT'
	, '', '', '', 'EDB'
	, '2017-06-19-17.44.00.091195'
    , '', '0', '0', '0', '0' );


SELECT * from DBSYSTC.EDS_LOAD_MAP 
WHERE DATA_ACT_FILE_I in (51149990257770810)
for fetch only;

INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770810
,51149990257770810
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-06-19-17.44.00.091195'
);

SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770810)
for fetch only;


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, PART_STAT_CD, ALT_PART_STAT_CD, ALT_TERM_REASON_CD,EXPECT_YR_SERV_C, EE_div_no
from  DBSYSTC.EMPLOYEE
WHERE soc_sec_no like '888-66%'
for fetch only;





SELECT * FROM DBSYSTC.PLAN_PROV_GRP
WHERE takeover_carrier_ind_c = 1 AND Account_NO in ('TA069542TX    00001');

SELECT * FROM DBSYSTC.PLAN_PROV_GRP
WHERE Account_NO like ('TA069542TX    00001');

select * from DBSYSTC.PLAN_PROV_GRP
fetch first 10 rows only;

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD 
FROM DBSYSTC.LOAN_DETAIL where case_no = 'AN62212TR 00001' and soc_sec_no = '045-08-3561';

SELECT * from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where ACCOUNT_NO='AN62212TR 00001' and SOC_SEC_NO = '045-08-3561';

Delete from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where ACCOUNT_NO='AN62212TR 00001' AND SOC_SEC_NO='045-08-3561'

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD 
FROM DBSYSTC.LOAN_DETAIL where case_no = 'AN62212TR 00001' and soc_sec_no = '145-29-6172';


SELECT *
FROM DBSYSTC.LOAN_DETAIL 
where case_no = 'AN62212TR 00001' and soc_sec_no in ('135-89-6072')
for fetch only;

Select * 
FROM DBSYSTC.PLAN_LOAN
--where PLAN_LOAN_I = 20061002901666;
fetch first 20 rows only;







Select * 
FROM DBSYSTC.PLAN_LOAN
where auto_reamort_c = 1;

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD
FROM DBSYSTC.LOAN_DETAIL
WHERE case_no = '752319    00001';

SELECT * from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where ACCOUNT_NO='752319    00001' and SOC_SEC_NO = '887-95-6609';


SELECT * from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where SOC_SEC_NO = '135-89-6072';

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD 
FROM DBSYSTC.LOAN_DETAIL where case_no = 'AN62212TR 00001' and soc_sec_no = '135-89-6072';





SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, PART_STAT_CD, ALT_PART_STAT_CD, ALT_TERM_REASON_CD,EXPECT_YR_SERV_C, EE_div_no
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO = 'AN62212TR 00001'
for fetch only;

-- case# tested =A50878    00001    ,   S22430    00001
SELECT CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD, EE_LOCATION, EE_SUB_LOCATION, EE_DIV_NO
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO = 'A50878    00001' and soc_sec_no = '556-60-5115';
--order by soc_sec_no
for fetch only;

--get the list of valid remit codes for specific case number
SELECT psd.TRANSLATION_C 
FROM   DBSYSTT.CO_SOURCE CS, 
       DBSYSTT.PLAN_PROV_GRP PPG, 
       DBSYSTT.PLAN_PROVISION PP, 
       DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='S22215    00001'  
      AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
      AND PP.PROV_TYP_C = 13 
      AND PP.PROVISION_I = PSD.SRC_I 
      AND PSD.SRC_TYP_C = CS.SRC_TYP_C 
                --AND CS.CTRB_SRC_C = '1'
      AND PSD.ACTIVE_SRC_C IN ('A')
FOR FETCH ONLY WITH UR;

select * from DBSYSTT.PLAN_SRC_DETAIL PSD
fetch first 10 rows only;


--//////////////////////////////////////////////



INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770840
, '7'
, '752319_new_51149990257770840.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-08-16-16.18.00.091195'
, '', '0', '0', '0', '0' );

SELECT * from DBSYSTC.EDS_LOAD_MAP
WHERE DATA_ACT_FILE_I in (51149990257770840)
for fetch only;


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770840
,51149990257770840
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-08-16-16.18.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770840)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770840 AND DATA_ACT_FILE_I=51149990257770840;


--***************************************** AUTOMATION

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE 
--CASE_NO ='651449    00001' 
 soc_sec_no like '888-66%'
for fetch only;


--******************************************* remit

--check the remit details

select *from DBSYSTC.BILL_REMIT_DETAIL
where CASE_NO = 'S22430    00001'
and SOC_SEC_NO = '005-31-5189';

-- returns the valid remit codes for a specific CASE#. esta query é igual a fornecida pelo Rafa
-- case used by Camila = S22430    00001
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C
FROM   DBSYSTT.CO_SOURCE CS,DBSYSTT.PLAN_PROV_GRP PPG, DBSYSTT.PLAN_PROVISION PP, DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='S22430    00001' 
		AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
        AND PP.PROV_TYP_C = 13                   
		AND PP.PROVISION_I = PSD.SRC_I                   
		AND PSD.SRC_TYP_C = CS.SRC_TYP_C                                     
		AND PSD.ACTIVE_SRC_C IN ('A')
FOR FETCH ONLY;

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD
FROM DBSYSTC.LOAN_DETAIL
WHERE case_no = 'S22430    00001' and SOC_SEC_NO='005-31-5189';

----***********************

SELECT ACCOUNT_NO,CLASS_C,CLASS_NM,CLASS_I,EXCLUSION_C, CLASS_PROV_I
FROM DBSYSTC.PLAN_PROVISION A,DBSYSTC.PLAN_PROV_GRP B  
,DBSYSTC.PLAN_CLASS C                                  
--WHERE ACCOUNT_NO in ('TT069090RF00001','TT080214RF00001','TT080215RF00001')
where account_no = 'A50878    00001'
AND A.ENRL_PROV_GRP_I=B.ENRL_PROV_GRP_I                
AND   C.CLASS_PROV_I=A.PROVISION_I                     
ORDER BY ACCOUNT_NO,EXCLUSION_C
WITH UR  FOR FETCH ONLY; 


SELECT ACCOUNT_NO,CLASS_C,CLASS_NM,CLASS_I,EXCLUSION_C, CLASS_PROV_I
FROM DBSYSTC.DBSYSTC.PLAN_PROV_GRP A,DBSYSTC.PLAN_PROVISION B, DBSYSTC.PLAN_CLASS C                                  
where A.account_no = '651736PD  00001'
AND A.ENRL_PROV_GRP_I=B.ENRL_PROV_GRP_I                
AND   C.CLASS_PROV_I=B.PROVISION_I                     
ORDER BY ACCOUNT_NO,EXCLUSION_C
WITH UR  FOR FETCH ONLY; 


SELECT *
FROM DBSYSTC.PLAN_PROVISION                            
WHERE enrl_prov_grp_i = 3638105353350500;


select *
from DBSYSTC.PLAN_CLASS
where class_prov_i=82707475353350500;

select *
from DBSYSTC.PLAN_PROVISION
where provision_i=82707475353350500;


select *
from DBSYSTC.PLAN_PROV_GRP
--where enrl_prov_grp_i=3638105353350500;
where account_no = 'A50878    00001';



select *
from DBSYSTC.PLAN_PROV_GRP
where enrl_prov_grp_i=3638105353350500;


Select * from DBSYSTC.EDS_BATCH_QUEUE
where DATA_ACT_FILE_I=39779521468022500;



select * from  DBSYSTC.MISC_FILE_FEED_SUMM
where file_i in (53671190889312500, 98306750889312500, 82870450889312500, 53830450889312500, 33440575175202500)
order by creation_ts DESC;
--file_I in (13077948277591500, 33440575175202500);
--case_no = 'JK62639KL 00001';
--fetch first 10 rows only;

select * from  DBSYSTC.MISC_FILE_FEED_SUMM
where sub_sys_typ_cd in ('31258')
order by creation_ts DESC;



select * from  DBSYSTC.MISC_FILE_FEED_SUMM
order by creation_ts DESC
fetch first 50 rows only;

select * from  DBSYSTC.MISC_FILE_FEED_SUMM
where file_i in (39779521468022500);
--(53225190468022500,49280650468022500,31364250468022500);
--53830450889312500;
--order by creation_ts DESC
--fetch first 1000 rows only;

select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 39779521468022500; 
--and soc_sec_no = '665-73-2378';
--fetch first 10 rows only;

select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 39779521468022500
order by tran_seq_no
fetch first 1000 rows only;

select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 53225190468022500 and soc_sec_no in ('033-28-8754', '033-88-7069', '043-09-3252', '043-68-7518');

select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 53225190468022500 and soc_sec_no in ('013-67-0955','026-13-7736','075-50-5286', '033270531','033-28-3130' );



select * from  DBSYSTC.MISC_FILE_FEED
where soc_sec_no in ('033-28-8754', '033-88-7069', '043-09-3252', '043-68-7518');


select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 53830450889312500 and soc_sec_no in ('565-51-4788', '465-54-2857', '865-33-2934', '865-81-3954', '075-11-5332' );



select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 53830450889312500 and soc_sec_no in ('075-11-5332' );


select * from  DBSYSTC.MISC_FILE_FEED
where file_i = 53830450889312500 and soc_sec_no in ('465-54-2857', '865-33-2934', '865-81-3954', '075-11-5332' )
order by tran_seq_no;


-- 965303438, 075505286, 765549612, 565514788, 465542857, 865332934, 865813954, 075115332
				              
SELECT * FROM DBSYSTP.EDS_BATCH_QUEUE 
--WHERE LOAD_TYP_C IN ('2') 
where DATA_TYP_I = 60877888721761500
order by MOD_TS DESC FETCH FIRST 1000 ROWS ONLY WITH UR;

SELECT * FROM DBSYSTP.EDS_BATCH_QUEUE 
where data_act_file_i = 39779521468022500;

-- ********************************************************************   VOLVO EE_DIV_NO = VMJ




SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_LOCATION, EE_div_no, MOD_TS, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO ='651479    00001' AND soc_sec_no in ('888-88-6524')
order by soc_sec_no
for fetch only;


SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ELIG_PRC_STAT_C, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_PART_STAT_CD,ALT_TERM_REASON_CD,EXPECT_YR_SERV_C
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO ='651449    00001' 
and  soc_sec_no = '888-77-1063'
for fetch only;



--Daisy create new ssn 888-88-6520
-- TC 1

Insert into DBSYSTP.CASE_PARTICIPANT_UDF_VALUES (CASE_NO, PARIS_UDF_ID, SOC_SEC_NO, RAW_VALUE, DISP_VALUE, UDF_STAT_C, CREATION_TS, MOD_TS, USER_I)
VALUES('651479    00001', '6220', '888-88-6526', 'VMJ', 'VMJ', 'A', '2017-07-25-08.20.10.661000', '2017-07-25-08.20.10', 'EDS');

Insert into DBSYSTP.CASE_PARTICIPANT_UDF_VALUES (CASE_NO, PARIS_UDF_ID, SOC_SEC_NO, RAW_VALUE, DISP_VALUE, UDF_STAT_C, CREATION_TS, MOD_TS, USER_I)
VALUES('651479    00001', '6220', '888-88-6520', 'VMJ', 'VMJ', 'A', '2017-07-24-12.59.10.661000', '2017-07-24-12.59.10', 'EDS');

Insert into DBSYSTP.CASE_PARTICIPANT_UDF_VALUES (CASE_NO, PARIS_UDF_ID, SOC_SEC_NO, RAW_VALUE, DISP_VALUE, UDF_STAT_C, CREATION_TS, MOD_TS, USER_I)
VALUES('651479    00001', '6220', '888-88-6522', 'VMJ', 'VMJ', 'A', '2017-07-24-17.22.10.661000', '2017-07-24-17.22.10', 'EDS');

Insert into DBSYSTP.CASE_PARTICIPANT_UDF_VALUES (CASE_NO, PARIS_UDF_ID, SOC_SEC_NO, RAW_VALUE, DISP_VALUE, UDF_STAT_C, CREATION_TS, MOD_TS, USER_I)
VALUES('651479    00001', '6220', '888-88-6523', 'VMJ', 'VMJ', 'A', '2017-07-24-17.55.10.661000', '2017-07-24-17.55.10', 'EDS');


select * from DBSYSTP.CASE_PARTICIPANT_UDF_VALUES
where soc_sec_no in ( '888-88-6514','888-88-6515','888-88-6520','888-88-6521', '888-88-6522', '888-88-6523', '888-88-6524', '888-88-6525', '888-88-6526')
order by soc_sec_no, creation_ts;

select * from DBSYSTP.CASE_PARTICIPANT_UDF_VALUES
where soc_sec_no in ( '888-88-6514')
order by soc_sec_no, creation_ts;



INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770876
, '7'
, 'non_Q51479_51149990257770876-to00.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-08-16-09.25.00.091195'
, '', '0', '0', '0', '0' );


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770876
,51149990257770876
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-08-16-09.25.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770876)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770876 AND DATA_ACT_FILE_I=51149990257770876;


--  **************************************************************************** IT-116913  - participant status *****************************************

--initially tested with non-QA case plans: 651215    00001 and 651643    00001 in the test DB DBSYSTC
-- Armel used this 651215
SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTC.EMPLOYEE    
WHERE CASE_NO in  ('651659    00001')--('651643    00001') --and soc_sec_no in ('888-77-1000', '888-77-1002', '888-77-1003')   
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;


--these are all the allowed values for Participant status
SELECT   * 
FROM     DBSYSTP.VHELPER2 
WHERE    HLP_CODE = 'APRTSTAT' 
; 



-- ***************************************************  on 8/4  - we started to test on AEGON DB DBSYSTK

select *
from DBSYSTK.PLAN_PROV_GRP
where ACCOUNT_NO in ('Q51643A   00001')--('651215    00001', 'Q51643    00001', 'Q51479    00001') --enrl_prov_grp_i=3638105353350500;
;

SELECT  CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTK.EMPLOYEE    WHERE CASE_NO = 'Q51215    00001' and soc_sec_no like '888-88-4%'   FOR FETCH ONLY WITH UR;

         --   Q51215  - 888-77-1030 to 888-77-1040
SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTK.EMPLOYEE    
WHERE CASE_NO in ('Q51643    00001')--, 'Q51215    00001') 
--and soc_sec_no in ('888-77-1025', '888-77-1002', '888-77-1003')   
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;

SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTK.EMPLOYEE    
WHERE CASE_NO in ('Q51215    00001', 'Q51643    00001', '651479    00001') and soc_sec_no like '888-77-10%'   
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;


SELECT *
FROM DBSYSTK.EMPLOYEE    
WHERE CASE_NO in ('Q51215    00001') and soc_sec_no like '888-77-10%'   
order by case_no
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;

SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, mod_ts
FROM DBSYSTK.EMPLOYEE    
WHERE CASE_NO in ('Q51215    00001') and soc_sec_no like '888-77-1049%'   
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;

SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, mod_ts 
FROM DBSYSTK.EMPLOYEE    
WHERE CASE_NO in ('Q51215    00001') and soc_sec_no in ('888-77-1047')--, '888-77-1050', '888-77-1051', '888-77-1052', '888-77-1053') --, '888-77-1040')
--soc_sec_no like '888-77-100%'   
--'651215    00001',
FOR FETCH ONLY WITH UR;


SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, EE_BRTH_DT, EE_REHIRE_DT, mod_ts 
FROM DBSYSTK.EMPLOYEE    
WHERE 
CASE_NO in ('Q51215    00001') 
and soc_sec_no like '888-77-10%'--, '888-77-1050', '888-77-1051', '888-77-1052', '888-77-1053') --, '888-77-1040')
FOR FETCH ONLY WITH UR;

--**********
SELECT ACCOUNT_NO, OES.* 
FROM DBSYSTK.OUTSRC_ELIG_SRC OES,
               DBSYSTK.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I ) IN ( SELECT ACCOUNT_NO, PROVISION_I
                        		  FROM DBSYSTK.PLAN_PROVISION PP, DBSYSTK.PLAN_PROV_GRP PPG
                                  WHERE ACCOUNT_NO IN ('Q51215    00001')
   								AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I                             
                                   AND PP.PROV_TYP_C = 80  -- Get the Outsourcing provision        
                                   )
               AND OES.SERV_LEV_C = 3 -- Client Managed Eligibility                                                    
FOR FETCH ONLY WITH UR;

SELECT ACCOUNT_NO, OES.* 
FROM DBSYSTP.OUTSRC_ELIG_SRC OES,
               DBSYSTP.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I ) IN (SELECT ACCOUNT_NO, PROVISION_I
                        		  FROM DBSYSTP.PLAN_PROVISION PP, DBSYSTp.PLAN_PROV_GRP PPG
                                  WHERE ACCOUNT_NO IN ('651215    00001')
   								AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I                             
                                   AND PP.PROV_TYP_C = 80  -- Get the Outsourcing provision        
                                   )
               AND OES.SERV_LEV_C = 3 -- Client Managed Eligibility                                                    
FOR FETCH ONLY WITH UR;



--corp
--NON-MANAGED PLAN = Q51479
SELECT ACCOUNT_NO, OES.* 
FROM DBSYSTC.OUTSRC_ELIG_SRC OES,
               DBSYSTC.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I ) IN (SELECT ACCOUNT_NO, PROVISION_I
                        		  FROM DBSYSTC.PLAN_PROVISION PP, DBSYSTC.PLAN_PROV_GRP PPG
                                  WHERE ACCOUNT_NO IN ('651215    00001') --651215
   								AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I                             
                                   AND PP.PROV_TYP_C = 80  -- Get the Outsourcing provision        
                                   )
               AND OES.SERV_LEV_C = 3 -- Client Managed Eligibility                                                    
FOR FETCH ONLY WITH UR;

select ACCOUNT_NO,  TAKEOVER_CARRIER_IND_C, TAKEOVER_CARRIER_TYP_C  
from DBSYSTK.PLAN_PROV_GRP  where TAKEOVER_CARRIER_IND_C = 1;

SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM  DBSYSTK.EDS_ENRL     WHERE CASE_NO = 'Q51215    00001' and soc_sec_no like '888-77-%' FOR FETCH ONLY WITH UR;


-- AFTER to update to '00' check the registers in the OUTSRC_ELIG_LOG table

--Armel - 888-88-10%
--PART_ENRL_I
SELECT * from DBSYSTP.EDS_ENRL
where case_no = 'Q51215    00001' and soc_sec_no like '888-77-1043%' --and part_enrl_i = 55888823383922500
ORDER BY MOD_TS DESC FOR FETCH ONLY WITH UR;

--- *************   aegon   
SELECT * from DBSYSTK.EDS_ENRL
where case_no = 'Q51215    00001' and soc_sec_no like '888-77-103%' --and part_enrl_i = 55888823383922500
ORDER BY MOD_TS DESC FOR FETCH ONLY WITH UR;

--89871340088732500 =>  888-77-1037
--74326930480832500 => 8888-77-1038
SELECT  * 
FROM DBSYSTK.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN ( 89871340088732500) --,75888823383922500, 95888823383922500,35888823383922500, 16881735207232500) 
--ANDOUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FETCH FIRST 50 ROWS ONLY FOR FETCH ONLY WITH UR;

--ELIG_LOG.OUTSRC_REF_I = EDS_ENRL.PART_ENRL_I
SELECT  * 
FROM DBSYSTK.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN (SELECT part_enrl_i from DBSYSTK.EDS_ENRL
						where case_no = 'Q51215    00001' and soc_sec_no in ('888-77-1041'))
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FOR FETCH ONLY WITH UR;

--EDS_ENRL.PART_ENRL_I = ELIG_LOG.OUTSRC_REF_I
--Armel test
SELECT  * 
FROM DBSYSTP.OUTSRC_ELIG_LOG
WHERE --OUTSRC_REF_I IN ( 72961941747332500) --,75888823383922500, 95888823383922500,35888823383922500, 16881735207232500) 
OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FETCH FIRST 50 ROWS ONLY FOR FETCH ONLY WITH UR;

-- Daisy test data
SELECT * from DBSYSTP.EDS_ENRL
where case_no = '651215    00001' and soc_sec_no in ('888-77-1014', '888-77-1015')
ORDER BY MOD_TS DESC FOR FETCH ONLY WITH UR;
-- part_enrl_i = 72961941747332500

SELECT  * 
FROM DBSYSTP.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN (SELECT part_enrl_i from DBSYSTP.EDS_ENRL
						where case_no = '651643    00001' and soc_sec_no in ('888-77-1021'))
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FOR FETCH ONLY WITH UR;

SELECT  * 
FROM DBSYSTP.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN ( 72961941747332500) --,75888823383922500, 95888823383922500,35888823383922500, 16881735207232500) 
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FETCH FIRST 50 ROWS ONLY FOR FETCH ONLY WITH UR;


SELECT  * 
FROM DBSYSTP.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN (SELECT part_enrl_i from DBSYSTP.EDS_ENRL
						where case_no = 'Q51215    00001' and soc_sec_no = '888-77-1041')
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FOR FETCH ONLY WITH UR;


-- Armel data test
SELECT  * 
FROM DBSYSTP.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN (SELECT part_enrl_i from DBSYSTP.EDS_ENRL
						where case_no = '651215    00001' and soc_sec_no = '888-88-1002')
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FOR FETCH ONLY WITH UR;


SELECT * FROM dbsystk.employee
WHERE case_no = 'Q51215    00001'  and ee_brth_dt = '19500101' --soc_sec_no = '000-00-9199'
FOR FETCH ONLY WITH UR;


SELECT * from DBSYSTK.EDS_BATCH_QUEUE
order by mod_ts desc
for fetch only;

SELECT * from DBSYSTK.EDS_LOAD_MAP
order by mod_ts desc
for fetch only;


INSERT INTO DBSYSTK.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (79243965803586021
, '7'
, 'fe_payout_79243965803586021.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2018-09-17-15.50.00.091195'
, '', '0', '0', '0', '0' );


INSERT INTO DBSYSTK.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(79243965803586021
,79243965803586021
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2018-09-17-15.50.00.091195'
);


SELECT * from DBSYSTK.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (79243965803586021)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTK.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=79243965803586021 AND DATA_ACT_FILE_I=79243965803586021;







-- non-managed plan: 651479    00001

select *
from DBSYSTC.PLAN_PROV_GRP
where ACCOUNT_NO in ('Q51215    00001', 'Q51643    00001', 'Q51479    00001') --enrl_prov_grp_i=3638105353350500;
;


select *
from DBSYSTC.PLAN_PROVISION
where enrl_prov_grp_i=18059129255561956
;


select *
from DBSYSTC.PLAN_CLASS
where class_i = 18059129255561956
;


-- list of code for employee.ALT_PART_STAT_CD
select * from DBSYSTC.VHELPER2 where hlp_code='APRTSTAT' ;

-- list of codes for  All SERV_TYP_C
SELECT HLP_VALUE, HLP_TEXT FROM dbsystc.helper2 WHERE HLP_CODE = 'OUT_SERV'



--  **************************************************************************** IT-    aegon

--MARC46 = 651643
--MMCNYO = 651215, 651216, 651288, 651337
--EDJON in corp = 651449, 651456, 651457 

select * from DBSYSTK.PLAN_PROV_GRP
where EMPLOYER_ID in ('MARC46', 'MMCNYO', 'EDJON')
FOR FETCH ONLY WITH UR;

-- ************* AEGON
-- 8/10: Alex verified that only one case is correctly configured. use it for test: 651215    00001
select * from DBSYSTK.PLAN_PROV_GRP
where account_no like 'A%' --'651215    00001' --('Q51643    00001', 'Q51215    00001', 'Q51216    00001', 'Q51288    00001', 'Q5337    00001')
FOR FETCH ONLY WITH UR;



select * from DBSYSTK.PLAN_PROV_GRP
where employer_id not like 'MMC%' --'651215    00001' --('Q51643    00001', 'Q51215    00001', 'Q51216    00001', 'Q51288    00001', 'Q5337    00001')
FOR FETCH ONLY WITH UR;

--AEGON schema
SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTK.EMPLOYEE    
WHERE 
CASE_NO = '651215    00001' 
--and soc_sec_no like '888-77-10%'   
and soc_sec_no like '888-77-106%'   
FOR FETCH ONLY WITH UR;

--'MMCNYO'
select * from DBSYSTK.PART_SSO_SECURE
where 
account_guid= '00D2F99449F912620800073109'
order by mod_ts desc
;

SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTK.EMPLOYEE    
WHERE 
CASE_NO = '651479    00001' 
--and soc_sec_no like '888-77-10%'   
--and soc_sec_no like '888-77-106%'   
FOR FETCH ONLY WITH UR;



-------*********** CORP - EDJONE
-- 8/10: Alex verified that only one case is correctly configured. use it for test: 651456 00001

select * from DBSYSTC.PLAN_PROV_GRP
where account_no = 'Q51479    00001'  --'651456    00001' 
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.PLAN_PROV_GRP
where EMPLOYER_ID like 'EDJ%'
FOR FETCH ONLY WITH UR;


SELECT CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, mod_ts 
FROM DBSYSTC.EMPLOYEE    
WHERE 
--CASE_NO like '651456%' 
soc_sec_no like '888-77-107%'   
--soc_sec_no like '887-23-8830%'   
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PART_SSO_SECURE
where account_guid = '00D28258C0C831A60600070809'
--where soc_sec_no like '888-77-1%'
order by mod_ts desc
;



-- returns more details of ssn that are in Part_sso_secure table
SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTC.EMPLOYEE    
WHERE  soc_sec_no in (select soc_sec_no from DBSYSTC.PART_SSO_SECURE
						where account_guid like 'ED%')
order by mod_ts desc
FOR FETCH ONLY WITH UR;




--  KEY VALUE 
INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770874
, '7'
, '651456_51149990257770868_C3-2.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-08-14-10.45.00.091195'
, '', '0', '0', '0', '0' );

select * from DBSYSTC.EDS_LOAD_MAP
WHERE 
DATA_ACT_FILE_I in (51149990257770874)
for fetch only;


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770874
,51149990257770874
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-08-14-10.45.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770874)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770874 AND DATA_ACT_FILE_I=51149990257770874;


SELECT  *
FROM    DBSYSTC.EMPLOYEE
WHERE   SOC_SEC_NO = '888-66-1000' 
AND     CASE_NO = '752319    00001'
;

-- #######    ########### ################                     ##########################################   ############################################
--**************************************** IT 116304 - EVENT PROCESSING MMC

-- Kay had set up a POG on each of the MMC test cases  Q51215, Q51216, and Q51643  I called the POG ACH LOAN 
SELECT *-- PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T, RELATED_GRP_TYP_C
FROM DBSYSTK.PLAN_PROV_GRP
WHERE ACCOUNT_NO = 'Q51216    00001' -- 'Q51479    00001';
--Mercer plans can be identified when takeover_carrier_ind_c is equal to 1:
;

--uma linha na PART_ENRL será adicionada para o PLAN_PROV_GRP.Related_GRP_TYP_C = 12 

--See Participants Enrollment Groups (I think), it is not on POG right now.
select * from dbsystk.part_enrl 
--where part_enrl_i = 17477060827542500 
order by part_enrl_i 
for fetch only with ur;

--See the Plans Provision Groups, ACH LOAN REPAY is the POG Kay created for the plans that has the RELATED_GRP_TYP_C = 12.
--Q51215 and Q51216 are 12 and Q51643 is  361
select * from dbsystk.PLAN_PROV_GRP where account_no in ('Q51215    00001','Q51216    00001','Q51643    00001') for fetch only with ur;




SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ALT_PART_STAT_CD, AUTO_ENRL_INCL_EXCL_C, OVRD_OPT_OUT_START_D,  ELIG_PRC_STAT_C,MOD_TS, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_TERM_REASON_CD,EXPECT_YR_SERV_C 
from  DBSYSTK.EMPLOYEE
WHERE 
--CASE_NO ='Q51215    00001' 
soc_sec_no like '888-77-0018%'
order by mod_ts desc
for fetch only;

SELECT CASE_NO, SOC_SEC_NO, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, EE_REHIRE_DT, ALT_PART_STAT_CD, AUTO_ENRL_INCL_EXCL_C, OVRD_OPT_OUT_START_D,  ELIG_PRC_STAT_C,MOD_TS, CLASS_I, EE_LOCATION, EE_div_no, EE_SUB_LOCATION, PART_STAT_CD, ALT_TERM_REASON_CD,EXPECT_YR_SERV_C 
from  DBSYSTK.EMPLOYEE
WHERE 
CASE_NO ='Q51643    00001' 
and soc_sec_no like '888-77-0021%'
order by mod_ts desc
for fetch only;

Select * from DBSYSTK.OUTSRC_ELIG_LOG
order by mod_ts desc
for fetch only with ur;

--records in here when updated alt_part_stat_cd to 04 and elig_prc_stat_c to 2
SELECT  * 
FROM DBSYSTK.OUTSRC_ELIG_LOG
WHERE OUTSRC_REF_I IN (SELECT part_enrl_i from DBSYSTK.EDS_ENRL
						where case_no = 'Q51643    00001' and soc_sec_no in ('888-77-0021'))
AND OUTSRC_ACT_TYP_C=4102  
ORDER BY MOD_TS DESC 
FOR FETCH ONLY WITH UR;

--I duplicated row from 888-77-0004 to this 888-77-016 to force the sc: existing spillover with spillover_c=0
select * from DBSYSTK.PART_SPILLOVER where soc_sec_no like '888-77-0004%'
;

-- ************************************  CREATE DEFERRALS

--Use to CONSULT your PART_ENL_I and ENRL_PROV_GRP_I to insert data into Part_def_data

SELECT   *
FROM     DBSYSTC.part_enrl_xref
WHERE    soc_sec_no like '225-43-0862%'
--AND account_no = 'Q51215    00001' 
FOR FETCH ONLY WITH UR;

ENRL_PROV_GRP_I  , SOC_SEC_NO   ,PART_ENRL_I
11067543195665293, 225-43-0862  ,33355803404024500

 
--use as BASE to create your deferrals: 
--                 this query returns 2 rows for each SSN (stat_=A). 
     --            you must to duplicate each row, updating the values to yours SSN, PART_ENRL_I and ENRL_PROV_GRP_I you got from step above.

--duplicate from one of these: ('998-85-5801', '888-77-0002')
select * from dbsystk.part_def_data 
where enrl_prov_grp_I = 18059129255561961
and soc_sec_no in ('888-77-0015')
for fetch only with ur; 

--after insert it will show up here
select * from dbsystk.part_def_data 
where 
soc_sec_no in ('888-77-0004') --, '888-77-0003', '888-77-0004')
--and enrl_prov_grp_I = 18059129255561961
for fetch only with ur; 


select * from dbsystk.part_def_data 
where enrl_prov_grp_I = 18059129255561961
and soc_sec_no in ('998-85-5801'
,'998-85-5802'
,'998-85-5803'
,'998-85-5804'
,'998-85-5805'
,'998-85-5806'
,'998-85-5807'
,'998-85-5808'
,'998-85-5809')
for fetch only with ur;

-- *********************  End - Create DEFERRALS


--*************** POG
SELECT * FROM DBSYSTK.PART_ENRL  
where part_enrl_i = 8218630141652500    
FOR FETCH ONLY
WITH UR;


--join tables to see POG
SELECT XR.ACCOUNT_NO, XR.ENRL_PROV_GRP_I, XR.RELATED_GRP_TYP_C, XR.SOC_SEC_NO, XR.PART_ENRL_I, XR.PERSON_I, XR.CREATE_TS, XR.MOD_TS, XR.SURROGATE_KEY, PE.PART_I, PE.ENRL_EFF_D, PE.ENRL_PROV_GRP_I, PE.ENRL_GRP_TYP_C, PE.ENRL_STAT_C, PE.USER_I, PE.MOD_TS, PE.INVESTOR_TYP_C
FROM     DBSYSTK.part_enrl_xref XR, DBSYSTK.PART_ENRL PE
WHERE    XR.soc_sec_no like '998-85-%'
     AND XR.account_no = 'Q51643    00001' 
     AND XR.PART_ENRL_I = PE.PART_ENRL_I
FOR FETCH ONLY WITH UR;



-- EVENTs 

-- execute these queries to verified if the events were triggered
SELECT * from dbsystk.EDS_PART_EVENT_DATA
WHERE    
--account_no = 'Q51643    00001'
      soc_sec_no like '888-77-00%'
for fetch only;

SELECT * from dbsystk.PART_EVENT_DATA
WHERE    
soc_sec_no like '888-77-00%'
--and account_no = 'Q51643    00001'
for fetch only;

--****** returns from part event and employee tables to see the event that were loaded along with other fields needed to validate.
SELECT EE.CASE_NO, EE.SOC_SEC_NO, EE.EE_HIRE_DT, EE.EE_TERM_DT,  EE.ALT_PART_STAT_CD, EE.ALT_TERM_REASON_CD, E.EVENT_C, E.EVENT_REASON_C, E.EVENT_D, E.CREATION_TS,E.MOD_TS
FROM DBSYSTK.EMPLOYEE  EE, DBSYSTK.PART_EVENT_DATA E  
WHERE   EE.SOC_SEC_NO like '888-77-0020%'  
and  EE.SOC_SEC_NO =  E.SOC_SEC_NO  
--and  EE.CASE_NO  like 'Q51215%'
;


-- UDF
select * from  dbsystk.CASE_PARTICIPANT_UDF_VALUES  
where paris_udf_id = '1405'  
and  udf_stat_c ='A'  
--and soc_sec_no = '888-%'
;

--This query give you the ppt total from all sources as required. 
SELECT SUM(TOTAL_A) AS TOTAL_A
FROM     DBSYSTC.EE_PART_BALANCE
WHERE    SOC_SEC_NO = '888-88-2009' 
AND TRANSACT_I IN (SELECT TRANSACT_I FROM DBSYSTC.EE_PART_BAL_HEADER EPBH, DBSYSTP.PLAN_PROVISION PP, DBSYSTP.PLAN_SRC_DETAIL PSD, DBSYSTP.CO_SOURCE CS
                   WHERE EPBH.CASE_NO = '650595    00001' 
                   AND EPBH.SRC_CD=1
                   AND EPBH.EFF_D = (SELECT MAX(EFF_D) FROM DBSYSTC.EE_PART_BAL_HEADER WHERE CASE_NO = '650595    00001' AND SRC_CD=1)
                   AND PP.ENRL_PROV_GRP_I = EPBH.ENRL_PROV_GRP_I
		           AND PP.PROV_TYP_C = 13 
                   AND PP.PROVISION_I = PSD.SRC_I 
                   AND PSD.SRC_TYP_C = CS.SRC_TYP_C
                   AND PSD.ACTIVE_SRC_C IN ('A')
                   AND PSD.translation_c IN ('A', 'G', '1', 'M','W'))
FOR FETCH ONLY;

SELECT SUM(TOTAL_A) AS TOTAL_A
FROM     DBSYSTK.EE_PART_BALANCE
WHERE    SOC_SEC_NO = '888-88-2009' 
AND TRANSACT_I IN (SELECT TRANSACT_I FROM DBSYSTK.EE_PART_BAL_HEADER EPBH, DBSYSTK.PLAN_PROVISION PP, DBSYSTK.PLAN_SRC_DETAIL PSD, DBSYSTK.CO_SOURCE CS
                   WHERE EPBH.CASE_NO = '650595    00001' 
                   AND EPBH.SRC_CD=1
                   AND EPBH.EFF_D = (SELECT MAX(EFF_D) FROM DBSYSTK.EE_PART_BAL_HEADER WHERE CASE_NO = '650595    00001' AND SRC_CD=1)
                   AND PP.ENRL_PROV_GRP_I = EPBH.ENRL_PROV_GRP_I
		           AND PP.PROV_TYP_C = 13 
                   AND PP.PROVISION_I = PSD.SRC_I 
                   AND PSD.SRC_TYP_C = CS.SRC_TYP_C
                   AND PSD.ACTIVE_SRC_C IN ('A')
                   AND PSD.translation_c IN ('A', 'G', '1', 'M','W'))
FOR FETCH ONLY;


select * from DBSYSTK.PART_ENRL_XREF
WHERE    
SOC_SEC_NO = '888-77-0001' 
and ACCOUNT_NO = 'Q51215    00001'
;
--.RELATED_GRP_TYP_C 

--related to plan entry tested by Rafa
select part_elec_req_c from dbsystk.case_data where case_no = 'Q51215    00001'

SELECT MAX(DATA_ACT_FILE_I)+1 from DBSYSTK.EDS_BATCH_QUEUE;

SELECT * from DBSYSTK.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770106)
order by mod_ts desc
for fetch only;

INSERT INTO DBSYSTK.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770119
, '7'
, 'LC_Q51643_51149990257770119.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-08-30-10.00.00.091195'
, '', '0', '0', '0', '0' );

SELECT * from DBSYSTK.EDS_LOAD_MAP
WHERE DATA_ACT_FILE_I in (51149990257770117) --(51149990257770873)
for fetch only;


INSERT INTO DBSYSTK.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770119
,51149990257770119
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-08-30-10.00.00.091195'
);


SELECT * from DBSYSTK.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in  (51149990257770119)
order by mod_ts desc
for fetch only;


--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTK.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770119 AND DATA_ACT_FILE_I=51149990257770119;



-- ****************** ################################ *************************  S P R I N T  8 - SEPT 2017

-- *************************** IT 118806
select * from DBSYSTC.case_participant_udf_values
order by mod_ts desc;
--CASE_NO,PARIS_UDF_ID,SOC_SEC_NO,RAW_VALUE,DISP_VALUE,UDF_STAT_C,CREATION_TS,MOD_TS,USER_I
--S51596    00001,1625,274-89-0768,5000.00,5000.00,H,2017-03-07-15.22.59.605093,2017-03-07-16.23.00.204000,UYP3D1

select * from DBSYSTC.case_participant_udf_values
-- where
--paris_udf_id like '162%'
order by mod_ts  desc
;

select * from DBSYSTC.CASE_PARTICIPANT_UDF_VALUES
where  case_no = 'Q51083    00001' 
order by soc_sec_no   
--soc_sec_no = '888-77-0039';
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = '651083    00001'  
and soc_sec_no like '888-77-00%'
;


select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no like '888-77-00%'
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, ee_rehire_dt, ee_term_dt,alt_part_stat_cd, mod_ts
from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0026','888-77-0027')
;


select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0036','888-77-0037')
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0038','888-77-0039','888-77-0040','888-77-0041','888-77-0042')
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0048','888-77-0049','888-77-0050','888-77-0051','888-77-0052', '888-77-0053', '888-77-0054', '888-77-0055')
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, mod_ts from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0043','888-77-0044')
;

select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, ee_rehire_dt, ee_term_dt,alt_part_stat_cd, mod_ts
from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0046','888-77-0047')
;


select case_no, soc_sec_no, class_i, ELIG_PRC_STAT_C, ee_hire_dt, ee_rehire_dt, ee_term_dt,alt_part_stat_cd, mod_ts
from DBSYSTC.EMPLOYEE
where case_no = 'Q51083    00001'  
and soc_sec_no in ('888-77-0045')
;



select * from DBSYSTC.EMPLOYEE
where 
case_no = 'Q51083    00001'  
and soc_sec_no like '888-77-00%'
;
 


select *
from dbsystc.plan_class
where class_prov_i
in (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
where account_no like 'Q51083%'));


-- IT 118787 - 651706 00001 EDS must default all new participants to the ALL EMPLOYEE CLASS

--TEST PLAN Q51706
select * from dbsystc.PLAN_PROV_GRP where account_no like 'Q51706%' for fetch only with ur;

SELECT ACCOUNT_NO,CLASS_C,CLASS_NM,CLASS_I,EXCLUSION_C, CLASS_PROV_I
FROM DBSYSTC.PLAN_PROVISION A,DBSYSTC.PLAN_PROV_GRP B  
,DBSYSTC.PLAN_CLASS C                                  
where account_no = 'Q51706    00001'
AND A.ENRL_PROV_GRP_I=B.ENRL_PROV_GRP_I                
AND   C.CLASS_PROV_I=A.PROVISION_I                     
ORDER BY ACCOUNT_NO,EXCLUSION_C
WITH UR  FOR FETCH ONLY   ;


select CASE_NO, SOC_SEC_NO, EE_LAST_NM, EE_FST_MID_NM, MIDDLE_NM, ALT_PART_STAT_CD, EE_MARITAL_STAT_CD, EE_SEX_CD, EE_BRTH_DT, EE_DIV_NO, CLASS_I, EE_HIRE_DT from dbsystc.employee
where soc_sec_no in ('888-77-0054')
;
'888-77-0052',
'888-77-0053',
'888-77-0054',
'888-77-0055');




--------------------------------


--  KEY VALUE 
INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770911
, '7'
, 'NewEnroll_651577NU_51149990257770911.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-09-29-13.30.00.091195'
, '', '0', '0', '0', '0' );

select * from DBSYSTC.EDS_LOAD_MAP
WHERE 
DATA_ACT_FILE_I in (51149990257770911)
for fetch only;


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770911
,51149990257770911
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-09-29-13.30.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770911)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770911 AND DATA_ACT_FILE_I=51149990257770911;




--- S P R I N T  9  ------  **************************** GAP 118  - IT  1 1 9 6 2 4  - NQDC


SELECT *-- PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T, RELATED_GRP_TYP_C
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO like '651577NU%';

select * from  DBSYSTC.PART_DIST_DEF_GRP
where enrl_prov_grp_i=11802452423791985
order by mod_ts desc;

select * from  DBSYSTC.Plan_distrib_grp
where  enrl_prov_grp_i=11802452423791985
--soc_sec_no like '888-77%'
;

---

select * from DBSYSTC.PLAN_NQDC_ELIG
where account_no ='651577NU  00001'  
;


select * from DBSYSTC.Part_Dist_Def_Grp
where enrl_prov_grp_i=11802452423791985
;

select * from DBSYSTC.Part_Dist_Def_Grp
where enrl_prov_grp_i in (SELECT ENRL_PROV_GRP_I
						  FROM DBSYSTC.PLAN_PROV_GRP
						  WHERE ACCOUNT_NO like '651577NU%')
and soc_sec_no in ('888-77-0109','888-77-0110')
for fetch only;

select * from DBSYSTC.Part_Dist_Def_Grp
where enrl_prov_grp_i in (SELECT ENRL_PROV_GRP_I
						  FROM DBSYSTC.PLAN_PROV_GRP
						  WHERE ACCOUNT_NO like '651577NU%')
order by soc_sec_no
for fetch only;


select * from DBSYSTC.EMPLOYEE
where 
case_no = '651577NU  00001'  
and soc_sec_no like '888-77-015%'
;



--  KEY VALUE 
INSERT INTO DBSYSTC.EDS_LOAD_MAP (
DATA_ACT_FILE_I
, MAP_TYP_C
, FILE_NM
, ACCOUNT_NO
, FILE_TYP_C
, SKIP_ROW_NO
, HEADER_ROW_C
, ORIG_MAP_DESC_T
, CONTROL_MAP_DETL_T
, EDS_NOTES_T
, EDS_DATA_MESG_T
, USER_I
, MOD_TS
, SERVICER_CD
, AWD_FLAG_C
, VALIDATE_FLAG_C
, IS_CASH_CONV_C
, DISC_TESTING_FLAG_C) 
values (51149990257770919
, '7'
, 'remitTC4_Q51658_51149990257770919.txt'
, 'GENERICEDB00001'
, '6', 1, ''
, 'KEY_VALUE_LAYOUT'
, '', '', '', 'EDB'
, '2017-10-09-16.40.00.091195'
, '', '0', '0', '0', '0' );


select * from DBSYSTC.EDS_LOAD_MAP
order by mod_ts desc;

select * from DBSYSTC.EDS_LOAD_MAP
WHERE 
DATA_ACT_FILE_I in (51149990257770919)
for fetch only;


INSERT INTO DBSYSTC.EDS_BATCH_QUEUE (
BATCH_QUEUE_I
,DATA_ACT_FILE_I
,ENRL_PROV_GRP_I
,DATA_TYP_I
,LE_I
,LOAD_TYP_C
,STAT_C
,USER_I
,MOD_TS) 
VALUES 
(51149990257770919
,51149990257770919
,8
,8
,8
,'1'
,'1'
,'EDB'
, '2017-10-09-16.40.00.091195'
);


SELECT * from DBSYSTC.EDS_BATCH_QUEUE
WHERE DATA_ACT_FILE_I in (51149990257770919)
for fetch only;

--update STAT_C to 0 right after the key value file is moved to EDSincoming folder
Update DBSYSTC.EDS_BATCH_QUEUE Set STAT_C=0 
where BATCH_QUEUE_I=51149990257770919 AND DATA_ACT_FILE_I=51149990257770919;



-- ***************************************** 



--********************    *****************************   IT 119301

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no like '888-77-008%'
;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0064','888-77-0065','888-77-0066','888-77-0067','888-77-0068','888-77-0069','888-77-0070','888-77-0071','888-77-0072','888-77-0073','888-77-0074','888-77-0075','888-77-0076','888-77-0077')
;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
;

select *    
from dbsystc.plan_prov_grp
where account_no = '651658MK  00001'
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no like '888-77-008%'
order by soc_sec_no 
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0064','888-77-0065','888-77-0066','888-77-0067','888-77-0068','888-77-0069','888-77-0070','888-77-0071','888-77-0072','888-77-0073','888-77-0074','888-77-0075','888-77-0076','888-77-0077')
order by soc_sec_no
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
order by soc_sec_no
;



select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
and udf_stat_c ='A'  
order by soc_sec_no
;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0093','888-77-0094','888-77-0095','888-77-0096','888-77-0097','888-77-0098','888-77-0099','888-77-0100','888-77-0101','888-77-0102','888-77-0103','888-77-0104','888-77-0105','888-77-0106')
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0093','888-77-0094','888-77-0095','888-77-0096','888-77-0097','888-77-0098','888-77-0099','888-77-0100','888-77-0101','888-77-0102','888-77-0103','888-77-0104','888-77-0105','888-77-0106')
order by soc_sec_no
;


-- to get the CLASS_C of a plan
select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
where account_no like '651658MK%'));


select * from dbsystc.plan_class 
where class_i in 
    (select class_i 
     from dbsystc.class_prov_xref 
     where provision_i in (select provision_i from dbsystc.plan_provision where enrl_prov_grp_i in( (select enrl_prov_grp_i from dbsystc.plan_prov_grp where account_no='651658MK  00001') )))
for fetch only with ur;


-- IT 118787 - 651706 00001 EDS must default all new participants to the ALL EMPLOYEE CLASS

--TEST PLAN Q51706
select * from dbsystc.PLAN_PROV_GRP where account_no like 'Q51706%' for fetch only with ur;

SELECT ACCOUNT_NO,CLASS_C,CLASS_NM,CLASS_I,EXCLUSION_C, CLASS_PROV_I
FROM DBSYSTC.PLAN_PROVISION A,DBSYSTC.PLAN_PROV_GRP B  
,DBSYSTC.PLAN_CLASS C                                  
where account_no = 'Q51706    00001'
AND A.ENRL_PROV_GRP_I=B.ENRL_PROV_GRP_I                
AND   C.CLASS_PROV_I=A.PROVISION_I                     
ORDER BY ACCOUNT_NO,EXCLUSION_C
WITH UR  FOR FETCH ONLY   ;


select * from DBSYSTC.EDS_LOAD_MAP
order by mod_ts desc
for fetch only;



--   ################################################################# S P R I N T  10 #######################################

--*************************************************  IT- 1 1 9 6 9 1

SELECT psd.TRANSLATION_C 
FROM   DBSYSTT.CO_SOURCE CS, 
       DBSYSTT.PLAN_PROV_GRP PPG, 
       DBSYSTT.PLAN_PROVISION PP, 
       DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='QK62454LG 00001'  
      AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I 
      AND PP.PROV_TYP_C = 13 
      AND PP.PROVISION_I = PSD.SRC_I 
      AND PSD.SRC_TYP_C = CS.SRC_TYP_C 
                --AND CS.CTRB_SRC_C = '1'
      AND PSD.ACTIVE_SRC_C IN ('A')
FOR FETCH ONLY WITH UR;


SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   DBSYSTT.CO_SOURCE CS, 
DBSYSTT.PLAN_PROV_GRP PPG, 
                DBSYSTT.PLAN_PROVISION PP, 
                DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='Q51658    00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;


select * from DBSYSTT.PLAN_SRC_DETAIL PSD
fetch first 10 rows only;

--Kay gave this plan - Q51658
select case_no, SPLIT_NEG_FROM_REMIT_C, INKIND_FOR_ER_STOCK_C
from DBSYSTC.CASE_DATA
where 
case_no= 'Q51658    00001' 
-- 'QK62454LG 00001'
FOR FETCH ONLY WITH UR;


SELECT * --CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO = 'Q51658    00001'  --'QK62454LG 00001'
--and soc_sec_no in ('363-40-5645','364-08-6460', '362-26-6711')
order by mod_ts desc
for fetch only with ur;

select * 
from DBSYSTC.Case_remit 
where case_no = 'Q51658    00001' --'QK62454LG 00001'
--and TR_NO ='1004'
and TR_REF_NO like '2017100992226%'
FOR FETCH ONLY WITH UR;

select * 
from DBSYSTC.bill_remit_detail
where 
case_no='Q51658    00001' --'QK62454LG 00001'
--and tr_ref_no like '2017%'
--and soc_sec_no in ('363-40-5645') --'362-26-6711','363-40-5645','364-08-6460')
;

select * from DBSYSTC.EDS_BILL_REMIT
where case_no = 'Q51658    00001'
and soc_sec_no = '002-07-6450'
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.NEG_CONTRIB_DATA
where case_no = 'Q51658    00001'
and soc_sec_no = '002-07-6450' --'183-70-4644'
FOR FETCH ONLY WITH UR;

--  check these queries later
   
	SELECT DATA_ACT_FILE_I, ENRL_PROV_GRP_I, DATA_TYP_I, LE_I, A.SRC_I, PSD.REPORT_1_NM||' '|| PSD.REPORT_2_NM AS SRC_NM, LOADED_A, NOT_LOADED_A, NEG_LOADED_A, NEG_NOT_LOADED_A, CTL_TOTALS_A, COMP_TYP_C, COMP_PERIOD_TYP_C 
    FROM DBSYSTP.EDS_CTL_MAP_DETL A , DBSYSTP.PLAN_SRC_DETAIL PSD 
	WHERE DATA_ACT_FILE_I = 84631460449221509
	AND ENRL_PROV_GRP_I NOT IN (8,7) 
	AND A.SRC_I = PSD.SRC_I 
	ORDER BY ENRL_PROV_GRP_I FOR FETCH ONLY WITH UR;



-- ********************************************  IT - 1 1 9 2 1 1 - SSO SECURE

select * from DBSYSTC.PLAN_PROV_GRP
where account_no = '651658MK  00001' 
FOR FETCH ONLY WITH UR;

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
where account_no like '651658MK  00001%'));

select * from DBSYSTC.PLAN_PROV_GRP
where EMPLOYER_ID like 'CBLS01%'
FOR FETCH ONLY WITH UR;


SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, mod_ts 
FROM DBSYSTC.EMPLOYEE    
WHERE 
case_no like '651658MK%'
--and soc_sec_no like '111-05-6901%'   
--and soc_sec_no like '888-77-107%'   
order by mod_ts desc
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PART_SSO_SECURE
where account_guid = '00D298FA560779C60400073809'
--where soc_sec_no like '888-77-1%'
order by mod_ts desc
;



-- returns more details of ssn that are in Part_sso_secure table
SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTC.EMPLOYEE    
WHERE  soc_sec_no in (select soc_sec_no from DBSYSTC.PART_SSO_SECURE
						where account_guid = '00D298FA560779C60400073809')
order by mod_ts desc
FOR FETCH ONLY WITH UR;


-- ********************************************  IT - 1 2 1 1 1 9 - SSO SECURE for COCA-COLA

select * from DBSYSTC.PLAN_PROV_GRP
where account_no = 'Q51705    00001' 
FOR FETCH ONLY WITH UR;

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
where account_no like 'Q51705    00001%'));

select * from DBSYSTC.PLAN_PROV_GRP
where EMPLOYER_ID like 'COKEE%'
FOR FETCH ONLY WITH UR;




SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C, mod_ts 
FROM DBSYSTC.EMPLOYEE    
WHERE 
case_no like 'Q51705 %'
--and soc_sec_no like '000-00-3002%'   
and soc_sec_no like '888-77-0161%'   
order by soc_sec_no desc
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PART_SSO_SECURE
where 
--account_guid = 'COKEEX'
soc_sec_no like '000-00-3002%'
order by mod_ts desc
;



-- returns more details of ssn that are in Part_sso_secure table
SELECT * --CASE_NO, SOC_SEC_NO, ALT_PART_STAT_CD, ELIG_PRC_STAT_C 
FROM DBSYSTC.EMPLOYEE    
WHERE  soc_sec_no in (select soc_sec_no from DBSYSTC.PART_SSO_SECURE
						where account_guid = 'COKEEX')
order by mod_ts desc
FOR FETCH ONLY WITH UR;

-- ##############################  *******************************************************#########  S P R I N T 11 ***********************

-- ******************************************** IT - 1 2 0 5 8 9 - AIG



select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like '651691    00001%'  
order by mod_ts desc
and soc_sec_no in ('864-10-8153')
;

select * from DBSYSTC.case_participant_udf_values
where case_no = 'Q51691    00001'
--and soc_sec_no in ('888-77-0093','888-77-0094','888-77-0095','888-77-0096','888-77-0097','888-77-0098','888-77-0099','888-77-0100','888-77-0101','888-77-0102','888-77-0103','888-77-0104','888-77-0105','888-77-0106')
order by mod_ts desc --soc_sec_no
;

--note: DPN1126 for AIG  , and the DPN are mapped to the appropriate comp_type for a given plan
select * from DBSYSTC.Compensation_translation
where account_no like 'Q51083%'--'Q51691%'
;

-- to get the CLASS_C of a plan
select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no like '651691    00001%'));

SELECT   *
FROM     DBSYSTP.PLAN_CLASS
WHERE    CLASS_PROV_I 
IN (SELECT PROVISION_I FROM DBSYSTP.PLAN_PROVISION 
    WHERE ENRL_PROV_GRP_I 
        IN (SELECT ENRL_PROV_GRP_I FROM DBSYSTP.PLAN_PROV_GRP WHERE ACCOUNT_NO LIKE 'Q51694    00001%'));

-- get the contribution sources available for a plan
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM,PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   DBSYSTT.CO_SOURCE CS, 
DBSYSTT.PLAN_PROV_GRP PPG, 
                DBSYSTT.PLAN_PROVISION PP, 
                DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='651691    00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;

 -- remit

select case_no, SPLIT_NEG_FROM_REMIT_C, INKIND_FOR_ER_STOCK_C
from DBSYSTC.CASE_DATA
where 
case_no= 'Q51691    00001' 
FOR FETCH ONLY WITH UR;


--CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
SELECT * 
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO = '651691    00001'
order by mod_ts desc
for fetch only with ur;



-- ***** Use these SSN for pre-test only 
     -- 003-67-1765    024-70-2587
select * 
from DBSYSTC.Case_remit 
where case_no = '651691    00001' 
and TR_REF_NO like '2017102492226V%'
FOR FETCH ONLY WITH UR;

select * 
from DBSYSTC.bill_remit_detail
where case_no='651691    00001'
and tr_ref_no like '2017102492226V%'
--and soc_sec_no in ('363-40-5645') --'362-26-6711','363-40-5645','364-08-6460')
;

select * from DBSYSTC.EDS_BILL_REMIT
where case_no = '651691    00001'
and data_act_file_i=51149990257770951
--and soc_sec_no in ('003-67-1765', '024-70-2587')
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.NEG_CONTRIB_DATA
where case_no = '651691    00001'
and soc_sec_no in ('888-77-1158')
FOR FETCH ONLY WITH UR;


-----  


--A W D testing issues fixes

-- get the contribution sources available for a plan
SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM,PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   DBSYSTT.CO_SOURCE CS, 
DBSYSTT.PLAN_PROV_GRP PPG, 
                DBSYSTT.PLAN_PROVISION PP, 
                DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='651691    00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;

--to list the ssn with outstanding loans
-- ALT_LOAN_NO corresponds to LOAN NUMBER to be informed into file
select case_no, soc_sec_no, loan_no, ALT_LOAN_NO, ln_repay_amt, ln_tr_stat_cd, INIT_LN_AMT, LN_REPAY_FREQ_CD
from dbsystc.loan_detail
where case_no like 'Q51691%'
and ln_tr_stat_cd = '0'
order by soc_sec_no
;

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, alt_loan_no, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD
FROM DBSYSTC.LOAN_DETAIL
WHERE case_no = 'S22430    00001' and SOC_SEC_NO='005-31-5189' and ln_tr_stat_cd = '0';
;

select case_no, soc_sec_no, loan_no, ALT_LOAN_NO, ln_repay_amt, ln_tr_stat_cd, INIT_LN_AMT, LN_REPAY_FREQ_CD
from dbsystc.loan_detail
where case_no like 'QK62253YY%'
and ln_tr_stat_cd = '0'
order by soc_sec_no
;

--remit will be created here:
select *from DBSYSTC.BILL_REMIT_DETAIL
where CASE_NO = 'S22430    00001'
and SOC_SEC_NO = '005-31-5189';

select *from DBSYSTC.BILL_REMIT_DETAIL
where CASE_NO = 'QK62253YY 00001'
and SOC_SEC_NO = '006-10-8813';


-- *******     ----- ############################   Savanna - Event LOA/LOA   - 121503


SELECT CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
from  DBSYSTC.EMPLOYEE
WHERE 
CASE_NO = 'Q51680    00001'
and soc_sec_no  in ('888-77-1160','888-77-1161', '888-77-1162', '888-77-1163')   --('888-77-1158','888-77-1159')   
for fetch only with ur;

SELECT CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
from  DBSYSTC.EMPLOYEE
WHERE 
CASE_NO = 'Q51680    00001'
and soc_sec_no  in ('888-77-1164','888-77-1165', '888-77-1166', '888-77-1167')   --('888-77-1158','888-77-1159')   
for fetch only with ur;


SELECT CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
from  DBSYSTC.EMPLOYEE
WHERE 
CASE_NO = 'Q51680    00001'
and soc_sec_no  in ('888-77-1168','888-77-1169', '888-77-1170', '888-77-1171')   --('888-77-1158','888-77-1159')   
for fetch only with ur;


SELECT SOC_SEC_NO, LN_GRACE_START_DT, LN_GRACE_PER_EX_DT, LN_TR_STAT_CD   FROM DBSYSTC.LOAN_DETAIL 
where  case_no = 'Q51680    00001'  and soc_sec_no  in ( '888-77-1164', '888-77-1165','888-77-1166','888-77-1167')   and LN_TR_STAT_CD = '0' 
;


select * from DBSYSTC.LOAN_DETAIL
where 
case_no like 'Q51680%'
order by mod_ts desc
;

-- '888-88-8800'

--post- LOA/LOA event processing:
--    LOAN_DETAIL.LN_GRACE_STAT_CD = B
--    LOAN_DETAIL.LN_GRACE_START_DT = EVENT DATE
--    LOAN_DETAIL.LN_GRACE_PER_EX_DT = Event date +12 months
-- '888-88-8800'
SELECT case_no, soc_sec_no, loan_no, LN_TR_STAT_CD, LN_GRACE_STAT_CD, LN_GRACE_START_DT, LN_GRACE_PER_EX_DT, mod_ts
FROM DBSYSTC.LOAN_DETAIL 
where  case_no = 'Q51680    00001'  
--and LN_TR_STAT_CD = '0' 
and loan_no = '2017082392223W' --soc_sec_no  in ('888-77-1160', '888-77-1161', '888-77-1162', '888-77-1163')   
;

SELECT case_no, soc_sec_no, loan_no, LN_TR_STAT_CD, LN_GRACE_STAT_CD, LN_GRACE_START_DT, LN_GRACE_PER_EX_DT
FROM DBSYSTC.LOAN_DETAIL 
where  case_no = 'Q51680    00001'  
and LN_TR_STAT_CD = '0' 
and soc_sec_no  in ('888-77-1164', '888-77-1165', '888-77-1166', '888-77-1167')   
;

SELECT case_no, soc_sec_no, loan_no, LN_TR_STAT_CD, LN_GRACE_STAT_CD, LN_GRACE_START_DT, LN_GRACE_PER_EX_DT, mod_ts
FROM DBSYSTC.LOAN_DETAIL 
where  case_no = 'Q51680    00001'  
and LN_TR_STAT_CD = '0' 
and soc_sec_no  in ('888-77-1168', '888-77-1169', '888-77-1170', '888-77-1171')   
;

-- when to check data on this table?
--select *
--FROM DBSYSTC.compensation_data

-- ************************************  CREATE DEFERRALS

--Use to CONSULT your PART_ENL_I and ENRL_PROV_GRP_I to insert data into Part_def_data
SELECT   *
FROM     DBSYSTC.part_enrl_xref
WHERE    soc_sec_no like '888-77-115%'
AND account_no = 'Q51680    00001' 
FOR FETCH ONLY WITH UR;

 
--use as BASE to create your deferrals: 
--                 this query returns 2 rows for each SSN (stat_=A). you must to duplicate each row, updating the values to yours SSN, PART_ENRL_I and ENRL_PROV_GRP_I
--duplicate from one of these: ('998-85-5801', '888-77-0002')
select * from dbsystc.part_def_data 
where enrl_prov_grp_I = 18059129255561961
and soc_sec_no in ('888-77-0015')
for fetch only with ur; 

--after insert it will show up here
select * from dbsystc.part_def_data 
where 
soc_sec_no in ('888-77-1158', '888-77-1159')
and enrl_prov_grp_I = 66800213097780911
for fetch only with ur; 

-- example of ppt
select * from dbsystk.part_def_data 
where enrl_prov_grp_I = 18059129255561961
and soc_sec_no in ('998-85-5801'
,'998-85-5802'
,'998-85-5803'
,'998-85-5804'
,'998-85-5805'
,'998-85-5806'
,'998-85-5807'
,'998-85-5808'
,'998-85-5809')
for fetch only with ur;

-- *********************************  End - Create DEFERRALS



-- EVENTs 

-- execute these queries to verified if the events were triggered
SELECT * from dbsystc.EDS_PART_EVENT_DATA
WHERE    
--account_no = 'Q51643    00001'
      soc_sec_no in ('888-77-1160', '888-77-1161', '888-77-1162', '888-77-1163')
for fetch only;

SELECT * from dbsystc.PART_EVENT_DATA
WHERE    
soc_sec_no in ('888-77-1160', '888-77-1161', '888-77-1162', '888-77-1163') --('004-36-4045', '888-77-1158', '888-77-1159')
--and account_no = 'Q51643    00001'
for fetch only;

--****** returns from part event and employee tables to see the event that were loaded along with other fields needed to validate.
SELECT EE.CASE_NO, EE.SOC_SEC_NO, EE.EE_HIRE_DT, EE.EE_TERM_DT,  EE.ALT_PART_STAT_CD, EE.ALT_TERM_REASON_CD, E.EVENT_C, E.EVENT_REASON_C, E.EVENT_D, E.CREATION_TS,E.MOD_TS
FROM DBSYSTK.EMPLOYEE  EE, DBSYSTK.PART_EVENT_DATA E  
WHERE   EE.SOC_SEC_NO like '888-77-0020%'  
and  EE.SOC_SEC_NO =  E.SOC_SEC_NO  
--and  EE.CASE_NO  like 'Q51215%'
;


-- ****************************************************   COKE EVENT REHIRE - IT 121772

SELECT CASE_NO, SOC_SEC_NO, EE_BRTH_DT, EE_HIRE_DT, EE_TERM_DT, EE_REHIRE_DT,ELIG_PRC_STAT_C, ADJUSTED_HIRE_DT, ADJUSTED_SERVICE_D, ALT_PART_STAT_CD, class_i,mod_ts
from  DBSYSTC.EMPLOYEE
WHERE 
soc_sec_no  in ('888-77-1239')
for fetch only with ur;


SELECT *--CASE_NO, SOC_SEC_NO, EE_BRTH_DT, EE_HIRE_DT, EE_TERM_DT, EE_REHIRE_DT,ELIG_PRC_STAT_C, ADJUSTED_HIRE_DT, ALT_PART_STAT_CD,ALT_TERM_REASON_CD, class_i,mod_ts
from  DBSYSTC.EMPLOYEE
WHERE 
--CASE_NO = 'Q51706    00001'
soc_sec_no  like '888-77-123%' --,'888-77-1228') 
for fetch only with ur;

SELECT * from dbsystc.EDS_PART_EVENT_DATA
WHERE    
--account_no = 'Q51643    00001'
      soc_sec_no like '888-77-123%'
for fetch only;

SELECT * from dbsystc.PART_EVENT_DATA
WHERE    
soc_sec_no like '888-77-124%'
--and account_no = 'Q51643    00001'
for fetch only;

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no like 'Q51706    00001%'));



-- #################################################################   ****************************** ######### S P R I N T 12 **************************************

--********* ********************************  Beneficiary for Campbell    - 113787

-- Q51658, Q51659, Q51660 - the 755030 is not needed
select * from DBSYSTC.PLAN_PROV_GRP
where account_no in ('651658    00001' ,'651659    00001','651660    00001')
FOR FETCH ONLY WITH UR;


select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no in ('651658    00001', '651659    00001', '651660    00001')))
--where account_no in ('Q51658    00001', 'Q51659    00001', 'Q51660    00001')))
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.Employee
where 
case_no in ('651658    00001', '651659    00001', '651660    00001')
and (soc_sec_no like '888-77-1154%' or soc_sec_no like '888-77-1155%' )--or soc_sec_no like '888-77-116%')
--soc_sec_no in ('026-82-0064', '075-82-0064', '478-62-0034', '501-23-1293')--'002-07-8984%'--'444-18%'
order by soc_sec_no desc
FOR FETCH ONLY WITH UR;
;

select * from DBSYSTC.BENE_HIST
where account_no like '651658%'--'651658MK%'
and soc_sec_no = '888-77-116%'
FOR FETCH ONLY WITH UR
;

--cp_i = bene_hist.address_i
select * from DBSYSTC.LE_ADDRESS
where cp_i = '42832357291413500'
FOR FETCH ONLY WITH UR;

-- joining BENE_HIST and LE_ADDRESS

select hist.person_i, hist.account_no, hist.soc_sec_no,hist.BENE_RELAT_C, hist.BENE_TYP_C, hist.BENE_ACCOUNT_NO, hist.BENE_SOC_SEC_NO, hist.BENE_DESIG_EFF_D, hist.BENE_PRCDS_SHR_P, hist.status_c, hist.address_i,addr.PHONE_NO, addr.EMAIL_ADDR_NM, addr.ADDR_LINE_1_T, addr.ADDR_LINE_2_T, addr.ADDR_LINE_3_T, addr.CITY_NM, addr.ST_C, addr.ZIP_C, addr.COUNTRY_C, hist.mod_ts
from DBSYSTC.BENE_HIST HIST, DBSYSTC.LE_ADDRESS ADDR
where 
(hist.account_no = '651658    00001' 
or hist.account_no = '651659    00001' 
or hist.account_no = '651660    00001')
and (hist.soc_sec_no in ('888-77-1171')
and hist.address_i = addr.cp_i and hist.status_c='A')
order by hist.bene_soc_sec_no, hist.status_c
FOR FETCH ONLY WITH UR
;

select person_i, LAST_NM, FST_MID_NM, MIDDLE_NM, BIRTH_D, GENDER_C, MOD_TS from DBSYSTC.PERSON_SEARCH
where person_i in 
  (select hist.person_i from DBSYSTC.BENE_HIST HIST, DBSYSTC.LE_ADDRESS ADDR
   where 
   (hist.account_no = '651658    00001' 
   or hist.account_no = '651659    00001' 
   or hist.account_no = '651660    00001')
   and (hist.soc_sec_no in ('888-77-1170')
   and hist.address_i = addr.cp_i )-- and hist.status_c='A')
  )
FOR FETCH ONLY WITH UR;

--get all the person_i for a SSN
select person_i, LAST_NM, FST_MID_NM, MIDDLE_NM, BIRTH_D, GENDER_C, MOD_TS from DBSYSTC.PERSON_SEARCH
where person_i in 
  (select person_i from DBSYSTC.EDS_BENEFICIARY where soc_sec_no in ('888-77-1170') )
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.EDS_BENEFICIARY where soc_sec_no in ('888-77-1170');

select hist.person_i, hist.account_no, hist.soc_sec_no,hist.BENE_RELAT_C, hist.BENE_TYP_C, hist.BENE_ACCOUNT_NO, hist.BENE_SOC_SEC_NO, hist.BENE_DESIG_EFF_D, hist.BENE_PRCDS_SHR_P, hist.status_c, hist.address_i,addr.PHONE_NO, addr.EMAIL_ADDR_NM, addr.ADDR_LINE_1_T, addr.ADDR_LINE_2_T, addr.ADDR_LINE_3_T, addr.CITY_NM, addr.ST_C, addr.ZIP_C, addr.COUNTRY_C, hist.mod_ts
from DBSYSTC.BENE_HIST HIST, DBSYSTC.LE_ADDRESS ADDR
where hist.account_no = '651658    00001'
and hist.soc_sec_no in ('888-77-1153', '888-77-1154', '888-77-1155', '888-77-1156', '888-77-1157','888-77-1158', '888-77-1159', '888-77-1160', '888-77-1161')
and hist.address_i = addr.cp_i
order by hist.bene_soc_sec_no, hist.status_c
FOR FETCH ONLY WITH UR
;

select hist.person_i, hist.account_no, hist.soc_sec_no,hist.BENE_RELAT_C, hist.BENE_TYP_C, hist.BENE_ACCOUNT_NO, hist.BENE_SOC_SEC_NO, hist.BENE_DESIG_EFF_D, hist.BENE_PRCDS_SHR_P, hist.status_c, hist.address_i,addr.PHONE_NO, addr.EMAIL_ADDR_NM, addr.ADDR_LINE_1_T, addr.ADDR_LINE_2_T, addr.ADDR_LINE_3_T, addr.CITY_NM, addr.ST_C, addr.ZIP_C, addr.COUNTRY_C, hist.mod_ts
from DBSYSTC.BENE_HIST HIST, DBSYSTC.LE_ADDRESS ADDR
where hist.account_no = '651658    00001'
and hist.soc_sec_no in ('888-77-1148', '888-77-1149', '888-77-1150', '888-77-1151', '888-77-1152')
and hist.address_i = addr.cp_i
order by hist.bene_soc_sec_no, hist.status_c
FOR FETCH ONLY WITH UR
;


-- joining BENE_HIST and LE_ADDRESS

select hist.person_i, hist.account_no, hist.soc_sec_no,hist.BENE_RELAT_C, hist.BENE_TYP_C, hist.BENE_ACCOUNT_NO, hist.BENE_SOC_SEC_NO, hist.BENE_DESIG_EFF_D, hist.BENE_PRCDS_SHR_P, hist.status_c, hist.address_i,addr.PHONE_NO, addr.EMAIL_ADDR_NM, addr.ADDR_LINE_1_T, addr.ADDR_LINE_2_T, addr.ADDR_LINE_3_T, addr.CITY_NM, addr.ST_C, addr.ZIP_C, addr.COUNTRY_C, hist.mod_ts
from DBSYSTC.BENE_HIST HIST, DBSYSTC.LE_ADDRESS ADDR
where hist.account_no = '651658    00001'
and hist.soc_sec_no in ('888-77-1162', '888-77-1163')
and hist.address_i = addr.cp_i
order by hist.bene_soc_sec_no, hist.status_c
FOR FETCH ONLY WITH UR
;

select person_i, LAST_NM, FST_MID_NM, MIDDLE_NM, BIRTH_D, GENDER_C, MOD_TS from DBSYSTC.PERSON_SEARCH
where person_i in 
  (select person_i from DBSYSTC.EDS_BENEFICIARY where case_no like '651658%' and soc_sec_no in ('888-77-1148', '888-77-1149', '888-77-1150', '888-77-1151', '888-77-1152') )
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.EDS_BENEFICIARY
where case_no like 'Q51660%'--'651658MK%'
and soc_sec_no in ('888-77-1130')
FOR FETCH ONLY WITH UR
;

SELECT * from DBSYSTC.EDS_ENRL
where case_no = '651576    00001' and soc_sec_no like '888-77-00%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;



-- ****************************************************** PROd issue  1 2 2 3 1 3 

SELECT PSD.SRC_I, PSD.SRC_TYP_C, PSD.TRANSLATION_C, PSD.SRC_S, PSD.DEFAULT_SRC_C, PSD.DIRECTED_SRC_C, PSD.ANNUAL_MTCH_C, PSD.COMBIN_DEFER_C, PSD.COMBIN_DEFER_LIM_P, PSD.CALC_FREQ_PER_C, PSD.CNDTL_CTRB_C, PSD.DEFER_CHG_PER_C, PSD.REINST_PER_C, PSD.DEFER_CHG_FREQ_CT, PSD.REINST_FREQ_CT, PSD.MAND_CTRB_EXCS_P, PSD.INTEG_LVL_C, PSD.MTCH_CTRB_DEPEND_C, PSD.SAFE_HRBR_MTCH_C, PSD.EFF_D, PSD.SRC_T, PSD.SRC_MIN_P, PSD.SRC_MIN_A, PSD.SRC_MAX_P, PSD.SRC_MAX_A, PSD.SRC_HCE_MIN_P, PSD.SRC_HCE_MAX_P, PSD.FORMULA_C, PSD.BKPT_I, PSD.ACTIVE_SRC_C, PSD.SETUP_COMPLETE_C, PSD.ENRL_ALLOW_C, PSD.REPORT_1_NM, PSD.REPORT_2_NM, PSD.SRC_HCE_LMT_A, PSD.SRC_HCE_LMT_P, PSD.SRC_LMT_P, PSD.SRC_LMT_A, PSD.FORMULA_HCE_C, PSD.PRINT_SEQ_NO, PSD.HCE_ALLOW_C, PSD.HCE_OVRD_C, PSD.CATCHUP_ALLOW_C, PSD.CATCHUP_MTCH_C, PSD.CATCHUP_METH_C, PSD.EXCS_BONUS_DEFER_C, PSD.EXCS_BONUS_DEFER_P, PSD.EXCS_BONUS_DEFER_A, PSD.HCE_SEP_FORMULA_C, PSD.SRC_REMIT_DISP_C, PSD.SRC_ALLOW_C, PSD.EXEC_HCE_ALLOW_C, PSD.SRC_EXEC_HCE_MAX_P, PSD.SRC_EXEC_HCE_MIN_P, PSD.DOC_NM, PSD.FORMULA_T, PSD.CTRB_CALC_DESC_T, PSD.DEFER_CHG_FREQ_T, PSD.REINST_FREQ_T, PSD.INTEG_LVL_DESC_T, PSD.FORMULA_HCE_T, PSD.USER_I, PSD.MOD_TS, PSD.AUTO_ENRL_DEF_C, PSD.AUTO_ENRL_DEF_P, PSD.DISTRIB_GRP_I, PSD.DEF_GRP_EFF_YR, PSD.ROTH_AUTO_ENRL_P, PSD.SP_REPORT_1_NM, PSD.SP_REPORT_2_NM, PSD.SPANISH_DOC_NM, PSD.RELATED_SRC_I, PSD.SUB_FORMULA_C, PSD.SUB_FORMULA_T, PSD.AUTO_ESCLT_C, PSD.AUTO_ESCLT_P, PSD.AUTO_ESCLT_MAX_P, PSD.AUTO_ESCLT_MMDD, PSD.AUTO_ESCLT_EFF_D, PSD.AUTO_ENRL_EFF_D, PSD.AUTO_ESCLT_GRP_C, PSD.DIST_GRP_EFF_YR, PSD.AUTO_ESCLT_INCR_C, PSD.AUTO_ESCLT_WAIT_NO, PSD.HCE_MAX_DEFER_A, PSD.EACA_EFF_D, PSD.EACA_IND_C, PSD.PPA_QACA_EFF_D, PSD.ER_CTRB_PFT_IND_C, PSD.AUTO_ENRL_APPLY_C, PSD.SIX_MONTH_REFUND_C, PSD.CREATION_TS, PSD.AUTO_RE_ENRL_C, PSD.AUTO_RE_ENRL_EFF_D, PSD.TRS_MNY_TYP_C, PSD.ALL_403B_CATCHUP_C, PSD.MONEY_TYP_NM, PSD.RELIUS_TYP_NM, PSD.EXT_SRC_C, PSD.HCE_4_ALLOW_C, PSD.HCE_4_MAX_P, PSD.HCE_4_MIN_P, PSD.DOC_APPL_OF_AE_C, PSD.ACA_ANY_EE_EXCL_C, PSD.ACA_ELIG_EE_EXCL_T, PSD.AE_AFF_ELEC_C, PSD.AE_AFF_ELEC_EXP_D, PSD.AE_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_C, PSD.AI_AFF_ELEC_INC_P, PSD.AI_AFF_ELEC_INC_MAX_P, PSD.AUTO_ESCLT_INITIAL_D, PSD.MTCH_CTRB_MAX_LIMIT_C, PSD.MTCH_CTRB_MAX_LIMIT_P, PSD.MTCH_CTRB_MAX_LIMIT_A, PSD.MTCH_CTRB_APPLIES_C, PSD.HCE_5_ALLOW_C, PSD.HCE_5_MAX_P, PSD.HCE_5_MIN_P, PSD.HCE_6_ALLOW_C, PSD.HCE_6_MAX_P, PSD.HCE_6_MIN_P, PSD.REQ_MAND_ELEC_C, PSD.REHIRE_AUTO_ENRL_C FROM   DBSYSTT.CO_SOURCE CS, 
DBSYSTT.PLAN_PROV_GRP PPG, 
                DBSYSTT.PLAN_PROVISION PP, 
                DBSYSTT.PLAN_SRC_DETAIL PSD 
WHERE PPG.ACCOUNT_NO ='Q51658    00001'
AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I
AND PP.PROV_TYP_C = 13
AND PP.PROVISION_I = PSD.SRC_I
AND PSD.SRC_TYP_C = CS.SRC_TYP_C
AND PSD.ACTIVE_SRC_C IN ('A')  FOR FETCH ONLY
;


select * from DBSYSTT.PLAN_SRC_DETAIL PSD
fetch first 10 rows only;

--Kay gave this plan - Q51658
select case_no, SPLIT_NEG_FROM_REMIT_C, INKIND_FOR_ER_STOCK_C
from DBSYSTC.CASE_DATA
where 
case_no= 'Q51658    00001' 
FOR FETCH ONLY WITH UR;


SELECT * --CASE_NO, SOC_SEC_NO, ALT_TERM_REASON_CD, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, ALT_PART_STAT_CD
from  DBSYSTC.EMPLOYEE
WHERE CASE_NO = 'Q51658    00001'  and ee_term_dt = '00000000'
--and soc_sec_no in ('183-70-4644')
order by mod_ts desc
for fetch only with ur;

select * 
from DBSYSTC.Case_remit 
where case_no = 'Q51658    00001' --'QK62454LG 00001'
--and TR_NO ='1004'
and TR_REF_NO like '2017110992222Q%'--'2017110992222%'
FOR FETCH ONLY WITH UR;

select * 
from DBSYSTC.bill_remit_detail
where 
case_no='Q51658    00001' 
and soc_sec_no in ('003-47-9024')
--and tr_ref_no like '2017%'
;

select * from DBSYSTC.EDS_BILL_REMIT
where case_no = 'Q51658    00001'
and soc_sec_no = '523-06-9731'
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.NEG_CONTRIB_DATA
where case_no = 'Q51658    00001'
and soc_sec_no in ( '523-06-9731')
and tr_ref_no = '20171109922227'
FOR FETCH ONLY WITH UR;


-- **************************************** IT - 122186 - Ardent change to class logic

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no in ('Q51083    00001')))
FOR FETCH ONLY WITH UR;


select CASE_NO, SOC_SEC_NO, CLASS_I, elig_prc_stat_c, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, MOD_TS
from DBSYSTC.Employee
where case_no like 'Q51083%'
and (soc_sec_no like '888-77-005%' or soc_sec_no like '888-77-006%') and soc_sec_no not in ('888-77-0059')
FOR FETCH ONLY WITH UR
;

select e.CASE_NO, e.SOC_SEC_NO, e.CLASS_I, e.elig_prc_stat_c, e.EE_FST_MID_NM, e.EE_LAST_NM, e.EE_HIRE_DT, e.EE_BRTH_DT, cla.CLASS_I, cla.CLASS_NM, cla.CLASS_C, e.mod_ts
from DBSYSTC.Employee E, dbsystc.plan_class CLA
where E.case_no like 'Q51083%'
and E.soc_sec_no in ('888-77-0067')
and E.class_i = CLA.class_i
;

select *--CASE_NO, SOC_SEC_NO, CLASS_I, elig_prc_stat_c, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, MOD_TS
from DBSYSTC.Employee
where case_no like 'Q51083%'
and soc_sec_no like '888-77-0067%' 
;

select * from DBSYSTC.CASE_PARTICIPANT_UDF_VALUES
where  case_no = 'Q51083    00001' 
order by mod_ts desc
;

-- ************************************  IT - 122417 - TCF investor

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no in ('Q51576    00001')))
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.PART_ENRL 
--where investor_typ_c <> 0 --.INVESTOR_TYP_C
order by mod_ts desc
;




select *--CASE_NO, SOC_SEC_NO, CLASS_I, elig_prc_stat_c, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, MOD_TS
from DBSYSTC.Employee
where case_no like 'Q51576%'
and soc_sec_no like '888-77-00%' 
;

SELECT * from DBSYSTC.EDS_ENRL
where case_no = 'Q51576    00001' and soc_sec_no like '888-77-0077%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PART_ENRL 
where part_enrl_i in(9595713856223500, 29595713856223500)
;

SELECT * from DBSYSTC.EDS_ENRL
where case_no = '651576    00001' and soc_sec_no like '888-77-00%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;


--ENRL_PROV_GRP_I,PART_ENRL_I
select * from DBSYSTC.PART_ENRL 
where part_enrl_i in(75585553946223500, 95585553946223500)
;


SELECT E.CASE_NO,e.SOC_SEC_NO,e.STAT_C,e.ENRL_TYP_C,e.EE_FST_MID_NM,e.EE_LAST_NM,e.EE_HIRE_D,e.EE_BRTH_D,e.INVESTOR_TYP_C,e.CLASS_I, p.PART_ENRL_I,p.ENRL_EFF_D,p.ENRL_STAT_C,p.INVESTOR_TYP_C
from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = 'Q51576    00001' and e.soc_sec_no in ('888-77-0083') --, '888-77-0081', '888-77-0082', '888-77-0083')
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;

SELECT * from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = '651576    00001' and e.soc_sec_no like '888-77-00%'
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;


-- #########################   ************************************************** ################################ S P R I N T    1 3  ************

--********* ********************************  ********  EVENT PROCESSING KELLOG   - 116311

-- Q51915, Q51916, Q51917, Q51918, Q51919, Q51924
select * from DBSYSTC.PLAN_PROV_GRP
where account_no in ('Q51915    00001' ,'Q51916    00001','Q51917    00001', 'Q51924    00001')
FOR FETCH ONLY WITH UR;

-- plans DO NOT ALLOW L O A N S
select * from DBSYSTC.PLAN_PROV_GRP
where account_no in ('Q51918    00001', 'Q51919    00001')
FOR FETCH ONLY WITH UR;

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no in ('Q51915    00001', 'Q51916    00001', 'Q51917    00001')))
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.Employee
where 
case_no like 'Q51659%'--'651658MK%'
and soc_sec_no like '888-77-11%'--'002-07-8984%'--'444-18%'
;


SELECT * --CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD, LN_GRACE_PER_EX_DT, LN_GRACE_START_DT, LN_GRACE_STAT_CD
FROM DBSYSTC.LOAN_DETAIL where case_no = 'AN62212TR 00001' and soc_sec_no = '045-08-3561';

SELECT * from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where ACCOUNT_NO='AN62212TR 00001' and SOC_SEC_NO = '045-08-3561';

Delete from DBSYSTC.LOAN_REAMORT_SCHLD_PEND
where ACCOUNT_NO='AN62212TR 00001' AND SOC_SEC_NO='045-08-3561'

SELECT CASE_NO, SOC_SEC_NO, LOAN_NO, INIT_LN_AMT, LN_REPAY_FREQ_CD, LN_TR_STAT_CD 
FROM DBSYSTC.LOAN_DETAIL where case_no = 'AN62212TR 00001' and soc_sec_no = '145-29-6172';



-- IT 122133 - use same queries from bene for campbell

-- ******************************************** IT 122465   - Kellogg/Campbell investor type c

select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no in ('Q51658    00001')))
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.PART_ENRL 
--where investor_typ_c <> 0 --.INVESTOR_TYP_C
order by mod_ts desc
;




select *--CASE_NO, SOC_SEC_NO, CLASS_I, elig_prc_stat_c, EE_FST_MID_NM,  EE_LAST_NM, EE_HIRE_DT, EE_BRTH_DT, EE_TERM_DT, PART_STAT_CD, MOD_TS
from DBSYSTC.Employee
where 
--case_no like 'Q51576%'
 soc_sec_no like '888-77-02%' 
;

--DATA_ACT_FILE_I,DATA_TYP_I
SELECT ENRL_PROV_GRP_I,PART_ENRL_I,PART_I,CASE_NO,SOC_SEC_NO,STAT_C,ENRL_TYP_C,EE_FST_MID_NM,EE_LAST_NM,EE_HIRE_D,EE_BRTH_D,INVESTOR_TYP_C,CLASS_I,MOD_TS
from DBSYSTC.EDS_ENRL
where case_no = 'Q51658    00001' and soc_sec_no like '888-77-0171%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;

select * from DBSYSTC.PART_ENRL 
where part_enrl_i in(32156063288623500)
;



SELECT BATCH_QUEUE_I,DATA_ACT_FILE_I,DATA_TYP_I,ENRL_PROV_GRP_I,PART_ENRL_I,PART_I,CASE_NO,SOC_SEC_NO,STAT_C,ENRL_TYP_C,EE_FST_MID_NM,EE_LAST_NM,EE_HIRE_D,EE_BRTH_D,INVESTOR_TYP_C,CLASS_I,EE_DIV_NO,MOD_TS,EE_DEF_EFF_DT
from DBSYSTC.EDS_ENRL
where case_no = '651576    00001' and soc_sec_no like '888-77-00%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;


--ENRL_PROV_GRP_I,PART_ENRL_I
select * from DBSYSTC.PART_ENRL 
where part_enrl_i in(75585553946223500, 95585553946223500)
;


SELECT E.CASE_NO,e.SOC_SEC_NO,e.STAT_C,e.ENRL_TYP_C,e.EE_FST_MID_NM,e.EE_LAST_NM,e.EE_HIRE_D,e.EE_BRTH_D,e.CLASS_I, p.PART_ENRL_I,p.ENRL_EFF_D,p.ENRL_STAT_C,p.INVESTOR_TYP_C
from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = 'Q51915    00001' and e.soc_sec_no like '888-77-016%'
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;



SELECT E.CASE_NO,e.SOC_SEC_NO,e.STAT_C,e.ENRL_TYP_C,e.EE_FST_MID_NM,e.EE_LAST_NM,e.EE_HIRE_D,e.EE_BRTH_D,e.CLASS_I, p.PART_ENRL_I,p.ENRL_EFF_D,p.ENRL_STAT_C,p.INVESTOR_TYP_C
from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = 'Q51658    00001' and e.soc_sec_no like '888-77-019%'
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;

SELECT * from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = '651576    00001' and e.soc_sec_no like '888-77-00%'
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;



-- *********    IT 120827  - ppt PR address

select *
from DBSYSTC.Employee
where 
--case_no like 'Q51576%'
 soc_sec_no like '888-77-02%' 
;

SELECT * FROM DBSYSTc.EMPLOYEE  
WHERE 
SOC_SEC_NO in ('888-77-0211')
--and 
--CASE_NO = 'Q51705    00001' 
FOR FETCH ONLY WITH UR; 

select * from DBSYSTC.CASE_PARTICIPANT_UDF_VALUES
where soc_sec_no like ''--'888-77-02%'
;



select * --person_i, LAST_NM, FST_MID_NM, MIDDLE_NM, BIRTH_D, GENDER_C, MOD_TS 
from DBSYSTC.PERSON_SEARCH
where soc_sec_no in ('888-77-0211') 
FOR FETCH ONLY WITH UR;


select * from DBSYSTC.LE_ADDRESS
where cp_i = 62892882868823500
FOR FETCH ONLY WITH UR
;

SELECT * from DBSYSTC.EDS_ENRL
where case_no = '651658    00001' and soc_sec_no like '888-77-02%' --and part_enrl_i = 55888823383922500
FOR FETCH ONLY WITH UR;


--ENRL_PROV_GRP_I,PART_ENRL_I
select * from DBSYSTC.PART_ENRL 
where part_enrl_i in(75585553946223500, 95585553946223500)
;


SELECT E.CASE_NO,e.SOC_SEC_NO,e.STAT_C,e.ENRL_TYP_C,e.EE_FST_MID_NM,e.EE_LAST_NM,e.EE_HIRE_D,e.EE_BRTH_D,e.INVESTOR_TYP_C,e.CLASS_I, p.PART_ENRL_I,p.ENRL_EFF_D,p.ENRL_STAT_C,p.INVESTOR_TYP_C
from DBSYSTC.EDS_ENRL E, DBSYSTC.PART_ENRL P
where e.case_no = 'Q51576    00001' and e.soc_sec_no in ('888-77-0083') --, '888-77-0081', '888-77-0082', '888-77-0083')
    and e.ENRL_PROV_GRP_I = p.ENRL_PROV_GRP_I
	and e.PART_ENRL_I = p.PART_ENRL_I
	and e.PART_i = p.PART_i
FOR FETCH ONLY WITH UR;


-- ********************************************   IT - 122097 - class change needed  1215 9008 and 1215 9007 and union code = 1

-- to get the CLASS_C of a plan
select *
from dbsystc.plan_class
where class_prov_i in
       (select provision_i
        from dbsystc.plan_provision
        where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no like '651658 %'))
and class_c in ('RFOVR201SDU', 'RFOVR20', 'RPUND201SDU', 'RPUND20', 'TSDU', 'T')
;


select * from dbsystc.plan_class 
where class_i in 
    (select class_i 
     from dbsystc.class_prov_xref 
     where provision_i in (select provision_i from dbsystc.plan_provision where enrl_prov_grp_i in( (select enrl_prov_grp_i from dbsystc.plan_prov_grp where account_no='651658    00001') )))
for fetch only with ur;

--to get class_prov_i that is equal to plan_prov_grp.provision_i
select * from dbsystc.plan_class where class_prov_i in (select provision_i from dbsystc.plan_prov_grp ppg, dbsystc.plan_provision pp
where ppg.account_no = '651658    00001'
and ppg.enrl_prov_grp_i = pp.enrl_prov_grp_i
and prov_typ_c='1023')
for fetch only with ur;


select case_no, soc_sec_no, union_ind_c, ee.class_i, class_c, ELIG_PRC_STAT_C,ee.MOD_TS
from dbsystc.employee ee, dbsystc.plan_class pc
where soc_sec_no in ('888-77-0218','888-77-0219','888-77-0220','888-77-0221','888-77-0222','888-77-0223') 
and case_no='651658MK  00001' and class_prov_i='62222218115592025' and ee.class_i = pc.class_i 
for fetch only with ur
;

select case_no, soc_sec_no, union_ind_c, ee.class_i, class_c, ELIG_PRC_STAT_C,ee.MOD_TS
from dbsystc.employee ee, dbsystc.plan_class pc
where soc_sec_no in ('888-77-0224','888-77-0225','888-77-0226','888-77-0227','888-77-0228','888-77-0229') 
and case_no='651658MK  00001' and class_prov_i='62222218115592025' and ee.class_i = pc.class_i 
for fetch only with ur
;

select case_no, soc_sec_no, union_ind_c, ee.class_i, class_c, ELIG_PRC_STAT_C,ee.MOD_TS
from dbsystc.employee ee, dbsystc.plan_class pc
where soc_sec_no in ('888-77-0230','888-77-0231','888-77-0232','888-77-0232','888-77-0233','888-77-0234') 
and case_no='651658MK  00001' and class_prov_i='62222218115592025' and ee.class_i = pc.class_i 
for fetch only with ur
;

select case_no, soc_sec_no, union_ind_c, ee.class_i, class_c, ELIG_PRC_STAT_C,ee.MOD_TS
from dbsystc.employee ee, dbsystc.plan_class pc
where soc_sec_no between '888-77-0236' and '888-77-0245' 
and case_no='651658    00001' and class_prov_i='62222218115592016' and ee.class_i = pc.class_i 
for fetch only with ur
;

select * from DBSYSTC.case_participant_udf_values
where --case_no = '651658MK  00001'
soc_sec_no between '888-77-0236' and '888-77-0245'
and paris_udf_id = 7000
order by soc_sec_no, udf_stat_c
for fetch only with ur 
;

select * from DBSYSTC.case_participant_udf_values
where --case_no = '651658MK  00001'
soc_sec_no in ('888-77-0224','888-77-0225','888-77-0226','888-77-0227','888-77-0228','888-77-0229')
and paris_udf_id = 7000
order by soc_sec_no, udf_stat_c
for fetch only with ur 
;

select * from DBSYSTC.case_participant_udf_values
where --case_no = '651658MK  00001'
soc_sec_no in ('888-77-0230','888-77-0231','888-77-0232','888-77-0233','888-77-0234','888-77-0235')
and paris_udf_id = 7000
order by soc_sec_no, udf_stat_c
for fetch only with ur 
;

select * from DBSYSTC.case_participant_udf_values
where --case_no = '651658MK  00001'
soc_sec_no in ('026-82-0064')
and paris_udf_id = 7000
order by soc_sec_no
for fetch only with ur 
;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0230','888-77-0231','888-77-0232','888-77-0232','888-77-0233','888-77-0234') 
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0064','888-77-0065','888-77-0066','888-77-0067','888-77-0068','888-77-0069','888-77-0070','888-77-0071','888-77-0072','888-77-0073','888-77-0074','888-77-0075','888-77-0076','888-77-0077')
order by soc_sec_no
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
order by soc_sec_no
;



select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0079','888-77-0080','888-77-0081','888-77-0082','888-77-0083','888-77-0084','888-77-0085','888-77-0086','888-77-0087','888-77-0088','888-77-0089','888-77-0090','888-77-0091','888-77-0092')
and udf_stat_c ='A'  
order by soc_sec_no
;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no = '651658MK  00001'  
and soc_sec_no in ('888-77-0093','888-77-0094','888-77-0095','888-77-0096','888-77-0097','888-77-0098','888-77-0099','888-77-0100','888-77-0101','888-77-0102','888-77-0103','888-77-0104','888-77-0105','888-77-0106')
;

select * from DBSYSTC.case_participant_udf_values
where case_no = '651658MK  00001'
and soc_sec_no in ('888-77-0093','888-77-0094','888-77-0095','888-77-0096','888-77-0097','888-77-0098','888-77-0099','888-77-0100','888-77-0101','888-77-0102','888-77-0103','888-77-0104','888-77-0105','888-77-0106')
order by soc_sec_no
;

--*******************  ###############################   SPRINT 16

-- IT 123674

-- to get the CLASS_C of a plan
select *
from dbsystc.plan_class
where class_prov_i in
       (select provision_i
        from dbsystc.plan_provision
        where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no like '651916%'))
and class_c in ('RFOVR201SDU', 'RFOVR20', 'RPUND201SDU', 'RPUND20', 'TSDU', 'T')
;


select * from dbsystc.plan_class 
where class_i in 
    (select class_i 
     from dbsystc.class_prov_xref 
     where provision_i in (select provision_i from dbsystc.plan_provision where enrl_prov_grp_i in( (select enrl_prov_grp_i from dbsystc.plan_prov_grp where account_no='651916    00001') )))
for fetch only with ur;

select case_no, soc_sec_no, union_ind_c, ee.class_i, class_c, ELIG_PRC_STAT_C,ee.MOD_TS
from dbsystc.employee ee, dbsystc.plan_class pc
where --soc_sec_no between '888-77-0236' and '888-77-0245' 
 case_no='651916    00001' and class_prov_i='2959160867982040' and ee.class_i = pc.class_i 
for fetch only with ur
;

select * from DBSYSTC.case_participant_udf_values
where --case_no = '651658MK  00001'
soc_sec_no between '888-77-0236' and '888-77-0245'
and paris_udf_id = 7000
order by soc_sec_no, udf_stat_c
for fetch only with ur 
;


select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
--case_no like 'Q51916%'  
 soc_sec_no like '888-77-10%'
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,ER_DIV_NO,EMPL_STAT_CD,CLASS_I,EE_SUB_LOCATION,UNION_IND_C,FULL_PART_IND_C,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_REHIRE_DT,PART_STAT_CD,EE_CYC_DT,ELIG_PRC_STAT_C,MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like 'Q51658%'  
and soc_sec_no like '888-77-10%'
order by mod_ts desc;
;

select * from DBSYSTC.case_participant_udf_values
where 
--case_no like '651916%'
soc_sec_no in ('888-77-1004','888-77-1005','888-77-1002', '888-77-1003') --,'888-77-0227','888-77-0228','888-77-0229--')
--paris_udf_id = '0431'
order by mod_ts desc, soc_sec_no, udf_stat_c
for fetch only with ur 
;


-- **************************************************  IT 122172 - MMC Workdat
-- 651929 and 651744
select * from dbsystc.plan_class 
where class_i in 
    (select class_i 
     from dbsystc.class_prov_xref 
     where provision_i in (select provision_i from dbsystc.plan_provision where enrl_prov_grp_i in( 
																		(select enrl_prov_grp_i from dbsystc.plan_prov_grp 
																		where account_no like '651215%') )))
for fetch only with ur;





select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where 
case_no like 'Q51215    00001%'  
and soc_sec_no like '888-77-10%'
order by mod_ts desc;


-- ************************************************** IT 123939 - Participant status 30

-- valid alt_part_stat_c values
select * from dbsystc.vhelper2 where HLP_CODE ='APRTSTAT';

--651216, 651643
select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where 
--case_no like 'Q51216%'-- 'Q51215    00001%'  --'Q51643%'
 soc_sec_no like '496-70-9418%' --'888-77-10%'
--and alt_part_stat_cd > '20'
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51216    00001%'  
and alt_part_stat_cd < '20'
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51643    00001%'  
and alt_part_stat_cd = '20'
order by mod_ts desc;




-- >= 30
select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51215    00001%'  
and soc_sec_no in ('387-23-0861','175-19-2494','002-46-1110')
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51216    00001%'  
and soc_sec_no in ('013-26-3956','026-51-1333','933-48-3012','105-67-1747')
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51643    00001%'  
and soc_sec_no in ('427-77-5031','496-70-9418','114-98-6756')
order by mod_ts desc;




--  < 20
select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51215    00001%'  
and soc_sec_no in ('888-88-9000','888-88-9001','275-40-1669', '155-99-8003','000-00-8002')
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51216    00001%'  
and soc_sec_no in ('000-00-9999','063-25-1311','591-48-4420')
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51643    00001%'  
and soc_sec_no in ('117-79-4853','252-07-5276','998-05-5822','998-05-5827')
order by mod_ts desc;

--   =20
select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51215    00001%'  
and soc_sec_no in ('888-77-1045','888-77-1040','133-48-3008')
order by mod_ts desc;


select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51216    00001%'  
and soc_sec_no in ('655-85-8479','336-47-9086')
order by mod_ts desc;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,EE_SEX_CD,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTK.EMPLOYEE
where case_no like 'Q51643    00001%'  
and soc_sec_no in ('933-48-3001','933-48-3008')
order by mod_ts desc;



--  ************************************       IT - 123861 - Highmark

--651929LB or 651929EM
--651744 and Q51744

SELECT PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T, RELATED_GRP_TYP_C
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO like '651929%' 
--Mercer plans can be identified when takeover_carrier_ind_c is equal to 1:
;



-- execute these queries to verified if the events were triggered
SELECT * from dbsystc.EDS_PART_EVENT_DATA
WHERE    
account_no = '651929LB  00001'
and      soc_sec_no like '888-77-104%'
for fetch only;

SELECT * from dbsystc.PART_EVENT_DATA
WHERE    
soc_sec_no like '888-77-10%'
--and account_no = '651929LB  00001'
for fetch only;

--****** returns from part event and employee tables to see the event that were loaded along with other fields needed to validate.
SELECT EE.CASE_NO, EE.SOC_SEC_NO, EE.EE_HIRE_DT, EE.EE_TERM_DT,  EE.ALT_PART_STAT_CD, EE.ALT_TERM_REASON_CD, E.EVENT_C, E.EVENT_REASON_C, E.EVENT_D, E.CREATION_TS,E.MOD_TS
FROM DBSYSTc.EMPLOYEE  EE, DBSYSTc.PART_EVENT_DATA E  
WHERE   EE.SOC_SEC_NO like '888-77-10%'  --and EE.CASE_NO like '651929LB%'
and  EE.SOC_SEC_NO =  E.SOC_SEC_NO  
and  EE.CASE_NO  = E.account_no
;



select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like '651744%' and --'Q51744    00001%'  or case_no like '651744    00001%'
soc_sec_no like '888-77-10%'
order by mod_ts desc;


-- *********************************************************************** IT 123656


-- to get the CLASS_C of a plan by CLASS_PROV_i
select *
from dbsystc.plan_class
where class_prov_i in
   (select provision_i
    from dbsystc.plan_provision
    where enrl_prov_grp_i in (select enrl_prov_grp_i    
                              from dbsystc.plan_prov_grp
                              where account_no like 'Q51083    00001%'));




SELECT PLAN_ENRL_I,ENRL_PROV_GRP_I,ACCOUNT_NO,TAKEOVER_CARRIER_IND_C,PROV_GRP_SRCH_NM,PROV_GRP_DESC_T, RELATED_GRP_TYP_C
FROM DBSYSTC.PLAN_PROV_GRP
WHERE ACCOUNT_NO like '651083%'
;

select * from DBSYSTC.case_participant_udf_values
where 
--case_no like 'Q51083%'
paris_udf_id = '1697'
and raw_value = 'A8'
order by mod_ts desc, soc_sec_no, udf_stat_c
for fetch only with ur;



SELECT ACCOUNT_NO, OES.* 
FROM DBSYSTC.OUTSRC_ELIG_SRC OES,
     DBSYSTC.PLAN_PROV_GRP PPGO
WHERE (ACCOUNT_NO, OUTSRC_I ) IN ( SELECT ACCOUNT_NO, PROVISION_I
                        		  FROM DBSYSTC.PLAN_PROVISION PP, DBSYSTC.PLAN_PROV_GRP PPG
                                  WHERE ACCOUNT_NO IN ('Q51083    00001')
   								AND PPG.ENRL_PROV_GRP_I = PP.ENRL_PROV_GRP_I                             
                                   --AND PP.PROV_TYP_C = 80  -- Get the Outsourcing provision        
                                   )
              -- AND OES.SERV_LEV_C = 3 -- Client Managed Eligibility                                                    
FOR FETCH ONLY WITH UR;



--note: DPN1126 for AIG  , and the DPN are mapped to the appropriate comp_type for a given plan
select * from DBSYSTC.Compensation_translation
where account_no like 'Q51083%'--'Q51691%'
;


-----

--PLAN_CLASS
SELECT *--ACCOUNT_NO,CLASS_C,CLASS_NM,CLASS_I,EXCLUSION_C, CLASS_PROV_I
FROM DBSYSTC.PLAN_PROVISION A,DBSYSTC.PLAN_PROV_GRP B,DBSYSTC.PLAN_CLASS C                                  
WHERE ACCOUNT_NO = 'Q51083    00001'
AND A.ENRL_PROV_GRP_I=B.ENRL_PROV_GRP_I                
AND   C.CLASS_PROV_I=A.PROVISION_I                     
ORDER BY ACCOUNT_NO,EXCLUSION_C
WITH UR  FOR FETCH ONLY; 


select * from dbsystc.UDF_CASE_FIELD_XREFS
WHERE CASE_NO IN ('651083    00001','Q51083    00001')
AND UDF_ID = 'DPN1697';


select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,CLASS_I,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like 'Q51083%%'  
and soc_sec_no in ('888-77-0078', '888-77-0079', '888-77-0080')
WITH UR  FOR FETCH ONLY; 

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,CLASS_I,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like 'Q51083%%'  
and soc_sec_no in ('888-77-0081', '888-77-0082', '888-77-0083')
WITH UR  FOR FETCH ONLY; 



 

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,CLASS_I,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like 'Q51083%%'  
--order by ee_div_no desc
and ee_div_no like 'LH%'
WITH UR  FOR FETCH ONLY;

select CASE_NO,SOC_SEC_NO,EE_DIV_NO,EE_BRTH_DT,EE_HIRE_DT,EE_REHIRE_DT, EE_TERM_DT,EE_FST_MID_NM,EE_LAST_NM,MIDDLE_NM,CLASS_I,ALT_PART_STAT_CD,ADJUSTED_HIRE_DT, MOD_TS
from DBSYSTC.EMPLOYEE
where 
case_no like 'Q51083%%'  
and soc_sec_no between '888-77-0093' and '888-77-0108'
WITH UR  FOR FETCH ONLY; 
 
select * from DBSYSTC.case_participant_udf_values
where 
case_no like 'Q51083%'
and soc_sec_no between '888-77-0093' and '888-77-0098'
and paris_udf_id = '1697'
order by mod_ts desc, soc_sec_no, udf_stat_c
for fetch only with ur 
;
